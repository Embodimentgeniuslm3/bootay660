!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash/capitalize"),require("@extensionengine/tce-utils"),require("lodash/filter"),require("lodash/flatMap"),require("lodash/intersection"),require("lodash/pick"),require("lodash/reduce"),require("lodash/reject"),require("lodash/partition"),require("lodash/takeRight"),require("lodash/find"),require("pluralize"),require("@extensionengine/vue-radio"),require("lodash/orderBy"),require("lodash/get"),require("lodash/throttle"),require("vuedraggable"),require("lodash/cloneDeep"),require("lodash/mapKeys"),require("lodash/values")):"function"==typeof define&&define.amd?define(["exports","lodash/capitalize","@extensionengine/tce-utils","lodash/filter","lodash/flatMap","lodash/intersection","lodash/pick","lodash/reduce","lodash/reject","lodash/partition","lodash/takeRight","lodash/find","pluralize","@extensionengine/vue-radio","lodash/orderBy","lodash/get","lodash/throttle","vuedraggable","lodash/cloneDeep","lodash/mapKeys","lodash/values"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TceComponents={},e.capitalize,e.tceUtils,e.filter,e.flatMap,e.intersection,e.pick,e.reduce,e.reject,e.partition,e.takeRgt,e.find,e.pluralize,e.vueRadio,e.orderBy,e.get,e.throttle,e.Draggable,e.cloneDeep,e.mapKeys,e.values)}(this,(function(e,t,n,i,a,r,s,o,d,c,l,u,m,v,f,p,h,y,b,g,_){"use strict";function C(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var w=C(t),x=C(i),E=C(a),A=C(r),k=C(s),R=C(o),$=C(d),S=C(c),F=C(l),I=C(u),D=C(m),O=C(f),T=C(p),B=C(h),j=C(y),q=C(b),U=C(g),z=C(_),L={name:"active-users",props:{users:{type:Array,default:function(){return[]}},size:{type:Number,default:36}},filters:{capitalize:w.default}};function P(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}P(".avatar[data-v-15a1beec]{transition:all .2s}.avatar img[data-v-15a1beec]{padding:.125rem}.avatar[data-v-15a1beec]:focus-within,.avatar[data-v-15a1beec]:hover{transform:scale(1.1);z-index:1}.avatar:focus-within img[data-v-15a1beec]:focus,.avatar:hover img[data-v-15a1beec]:focus{outline:0}");var N=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="ActiveUsers.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"d-flex align-center"},e._l(e.users,(function(t){var i=t.id,a=t.label,r=t.imgUrl;return n("v-avatar",{key:i,staticClass:"avatar",attrs:{size:e.size,color:"pink accent-2"}},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[r?n("img",e._g({attrs:{src:r,alt:a,"aria-describedby":"activeUser-"+i,tabindex:"0"}},s)):e._e()]}}],null,!0)},[e._v(" "),n("span",{attrs:{id:"activeUser-"+i}},[e._v(e._s(a))])])],1)})),1)},staticRenderFns:[]},0,L,"data-v-15a1beec",!1),V={name:"add-new-element",props:{library:{type:Array,required:!0},allowedTypes:{type:Array,required:!0}},methods:{isAllowed:function(e){return!this.allowedTypes.length||this.allowedTypes.includes(e)}}};P(".element-container[data-v-5e4d908e]{min-height:20rem;padding:0 0 1.875rem;border-top-left-radius:.5rem;border-top-right-radius:.5rem;overflow:hidden}.group-heading[data-v-5e4d908e]{margin:0 2.5rem .375rem;padding-top:.5rem;font-size:.875rem;font-weight:500;line-height:1rem;text-align:left}.group-elements[data-v-5e4d908e]{display:flex;flex-wrap:wrap;width:100%;padding:0 1.875rem}.add-element[data-v-5e4d908e]{width:8.125rem;min-width:8.125rem;height:auto!important;min-height:4.375rem;padding:0!important;white-space:normal}.add-element[data-v-5e4d908e]  .v-btn__content{flex:1 1 100%;flex-direction:column;padding:.375rem;text-transform:none}.add-element .v-icon[data-v-5e4d908e]{padding:.125rem 0;font-size:1.875rem}.add-element .button-text[data-v-5e4d908e]{margin:.625rem 0}");var H=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="AddNewElement.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-bottom-sheet",e._g(e._b({attrs:{"max-width":"1240",inset:""}},"v-bottom-sheet",e.$attrs,!1),e.$listeners),[n("div",{staticClass:"element-container grey lighten-5"},[n("div",{staticClass:"d-flex align-center py-4 px-10"},[e._t("header")],2),e._v(" "),e._l(e.library,(function(t){return n("div",{key:t.name},[n("div",{staticClass:"group-heading grey--text text--darken-4"},[e._v(e._s(t.name))]),e._v(" "),n("div",{staticClass:"group-elements"},e._l(t.elements,(function(t){return n("v-hover",{key:t.position,scopedSlots:e._u([{key:"default",fn:function(i){var a=i.hover;return[n("v-btn",{staticClass:"add-element",attrs:{disabled:!e.isAllowed(t.type),color:a?"secondary accent-2":"blue-grey darken-4",text:""},on:{click:function(n){return n.stopPropagation(),e.$emit("add",[t])}}},[t.ui.icon?n("v-icon",{attrs:{size:"26",color:"primary darken-3"}},[e._v("\n              "+e._s(t.ui.icon)+"\n            ")]):e._e(),e._v(" "),n("span",{staticClass:"button-text body-2"},[e._v(e._s(t.name))])],1)]}}],null,!0)})})),1)])}))],2)])},staticRenderFns:[]},0,V,"data-v-5e4d908e",!1),M=6,W=12,K=[{name:"Content Elements",icon:"mdi-set-center"},{name:"Assessments",icon:"mdi-help-rhombus"},{name:"Nongraded questions",icon:"mdi-comment-question-outline"}];var Q=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="index.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"add-element-container"},[e._t("default",[e.large?n("v-btn",{staticClass:"mt-3 mb-4",attrs:{color:"primary darken-3",text:""},on:{click:function(t){return t.stopPropagation(),e.showElementPicker(t)}}},[n("v-icon",{staticClass:"pr-2"},[e._v(e._s(e.icon))]),e._v(e._s(e.label)+"\n    ")],1):n("v-btn",{attrs:{color:"primary darken-3",icon:"",text:""},on:{click:function(t){return t.stopPropagation(),e.showElementPicker(t)}}},[n("v-icon",[e._v(e._s(e.icon))])],1)],{addElement:e.showElementPicker}),e._v(" "),e.isVisible?[e.showElementBrowser?n("select-element",{attrs:{"allowed-types":e.allowedTypes,"submit-label":"Copy",heading:"Copy elements","header-icon":"mdi-content-duplicate",multiple:""},on:{selected:e.addElements,close:function(t){e.showElementBrowser=!1}}}):n("add-new-element",{attrs:{library:e.library,"allowed-types":e.allowedTypes},on:{add:e.addElements},scopedSlots:e._u([{key:"header",fn:function(){return[e.layout?n("div",{staticClass:"mr-6"},[n("div",{staticClass:"pb-1 caption text-left"},[e._v("Element width")]),e._v(" "),n("v-btn-toggle",{attrs:{color:"secondary accent-2",mandatory:""},model:{value:e.elementWidth,callback:function(t){e.elementWidth=t},expression:"elementWidth"}},[n("v-btn",{attrs:{value:100,height:"38",icon:""}},[n("v-icon",[e._v("mdi-square-outline")])],1),e._v(" "),n("v-btn",{attrs:{value:50,height:"38",icon:""}},[n("v-icon",[e._v("mdi-select-compare")])],1)],1)],1):e._e(),e._v(" "),n("v-btn",{staticClass:"mt-6",attrs:{color:"primary darken-3",depressed:""},on:{click:function(t){e.showElementBrowser=!e.showElementBrowser}}},[n("v-icon",{staticClass:"mr-2",attrs:{dense:""}},[e._v("mdi-content-copy")]),e._v("\n          Copy existing\n        ")],1)]},proxy:!0}],null,!1,2543524328),model:{value:e.isVisible,callback:function(t){e.isVisible=t},expression:"isVisible"}})]:e._e()],2)},staticRenderFns:[]},0,{name:"add-element",inject:["$teRegistry"],props:{items:{type:Array,required:!0},activity:{type:Object,default:null},position:{type:Number,default:null},layout:{type:Boolean,default:!0},include:{type:Array,default:null},show:{type:Boolean,default:!1},large:{type:Boolean,default:!1},label:{type:String,default:"Add content"},icon:{type:String,default:"mdi-plus"}},data:function(){return{isVisible:!1,elementWidth:100,showElementBrowser:!1}},computed:{registry:function(){return this.$teRegistry.all},questions:function(){return x.default(this.registry,{type:"QUESTION"})},contentElements:function(){var e=this,t=x.default(this.registry,(function(e){return!n.isQuestion(e.type)}));return this.isSubset?x.default(t,(function(t){return e.include.includes(t.type)})):t},assessments:function(){var e=this.registry,t=this.isSubset,n=this.include,i=this.questions;return t&&!n.includes("ASSESSMENT")?[]:x.default(e,{type:"ASSESSMENT"}).concat(i.map((function(e){return Object.assign({},e,{type:"ASSESSMENT"})})))},reflections:function(){var e=this.registry,t=this.isSubset,n=this.include,i=this.questions;return t&&!n.includes("REFLECTION")?[]:x.default(e,{type:"REFLECTION"}).concat(i.map((function(e){return Object.assign({},e,{type:"REFLECTION"})})))},isSubset:function(){return!!this.include&&!!this.include.length},library:function(){var e=[this.contentElements,this.assessments,this.reflections];return R.default(e,(function(e,t,n){return t.length&&e.push(Object.assign({},K[n],{elements:t})),e}),[])},processedWidth:function(){return 50===this.elementWidth?M:W},allowedTypes:function(){var e=this.elementWidth,t=this.include,n=this.layout,i=this.library,a=E.default(i,"elements");if(!n)return t||[];var r=(100===e?a:$.default(a,"ui.forceFullWidth")).map((function(e){return e.type}));return t?A.default(t,r):r}},methods:{addElements:function(e){var t=this,i=n.getPositions(this.items,this.position,e.length),a=e.map((function(e,n){return t.buildElement(Object.assign({},e,{position:i[n]}))}));this.$emit("add",a),this.isVisible=!1},buildElement:function(e){var t=this.processedWidth,i=this.activity,a=e.position,r=e.subtype,s=e.data,o=void 0===s?{}:s,d=e.initState,c=void 0===d?function(){return{}}:d,l=Object.assign({position:a},k.default(e,["type","refs"]),{data:Object.assign({},c(),o,{width:t})}),u=i?{activityId:i.id}:{id:n.uuid(),embedded:!0};return Object.assign(l,u),n.isQuestion(l.type)&&(l.data=function(e,t){var i={width:W},a=[{id:n.uuid(),data:i,type:"JODIT_HTML",embedded:!0}];return Object.assign({question:a,type:t},e.data)}(l,r)),"REFLECTION"===l.type&&delete l.data.correct,l},onHidden:function(){this.elementWidth=100,this.$emit("hidden")},showElementPicker:function(){this.isVisible=!0}},watch:{isVisible:function(e,t){!e&&t&&this.onHidden()},show:function(e){return e?this.showElementPicker():this.onHidden()}},components:{AddNewElement:H,SelectElement:function(){return import("components/common/SelectElement")}}},void 0,!1);function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){a=!0,r=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw r}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var X=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="EditorLink.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editor-link"},[n("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("router-link",{attrs:{to:e.editorRoute},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.navigate,r=t.isExactActive;return[n("v-btn",e._g(e._b({attrs:{color:r?"teal accent-4":"primary",text:"","x-small":""},on:{click:a}},"v-btn",e.$attrs,!1),i),[e._v("\n          "+e._s(e.label)+"\n          "),e._t("icon",[n("v-icon",{staticClass:"ml-1",attrs:{"x-small":""}},[e._v("mdi-arrow-top-right-thick")])])],2)]}}],null,!0)})]}}])},[e._v(" "),e._t("tooltip",[n("span",[e._v("View element")])])],2)],1)},staticRenderFns:[]},0,{name:"editor-link",props:{activityId:{type:Number,required:!0},elementUid:{type:String,default:null},label:{type:String,required:!0}},computed:{editorRoute:function(e){var t=e.activityId,n=e.elementUid;return Object.assign({name:"editor",params:{activityId:t}},n&&{query:{elementId:n}})}}},void 0,!1),Y={name:"comment-header",props:{comment:{type:Object,required:!0},isActivityThread:{type:Boolean,default:!1},isResolved:{type:Boolean,default:!1},elementLabel:{type:String,default:null},user:{type:Object,required:!0}},computed:{elementUid:function(e){return e.comment.contentElement.uid},author:function(e){return e.comment.author},isAuthor:function(e){return e.author.id===e.user.id},isDeleted:function(e){return!!e.comment.deletedAt},showEditedLabel:function(e){return!!e.comment.editedAt},showOptions:function(e){return e.isAuthor&&!e.isDeleted&&!e.isResolved},options:function(){var e={resolve:{action:"resolve",icon:"check-box-outline",color:"teal accent-4"},edit:{action:"toggleEdit",icon:"pencil-outline",color:"grey"},remove:{action:"remove",icon:"trash-can-outline",color:"grey"}};return this.isActivityThread&&delete e.resolve,e}},components:{EditorLink:X}};P(".header[data-v-a1e0c4e8]{display:flex;align-items:flex-start}.header .comment-avatar[data-v-a1e0c4e8]{margin:.375rem .375rem 0 0}.header .info-container[data-v-a1e0c4e8]{display:flex;flex-direction:column;flex:0 100%;max-width:calc(100% - 8rem);margin-left:.125rem}.header .info-container .author[data-v-a1e0c4e8]{display:inline-block;max-width:75%;color:#000;font-size:1rem}.header .info-container .edited[data-v-a1e0c4e8],.header .info-container .time[data-v-a1e0c4e8]{color:#888;font-size:.75rem}.header .info-container hr.v-divider--vertical[data-v-a1e0c4e8]{margin:.25rem .125rem .125rem .625rem}.header .info-container[data-v-a1e0c4e8]  .editor-link{display:inline-flex;align-self:flex-end}.header .actions[data-v-a1e0c4e8]{margin-left:auto}");var Z=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="Header.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header"},[n("v-avatar",{staticClass:"comment-avatar",attrs:{size:"34"}},[n("img",{attrs:{src:e.author.imgUrl}})]),e._v(" "),n("div",{staticClass:"info-container"},[n("div",{staticClass:"d-flex align-center"},[n("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"author text-truncate"},i),[e._v(e._s(e.author.label))])]}}])},[e._v("\n        "+e._s(e.author.label)+"\n      ")]),e._v(" "),e.showEditedLabel?n("span",{staticClass:"edited ml-1"},[e._v("(edited)")]):e._e()],1),e._v(" "),n("div",{staticClass:"d-flex align-center"},[n("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({},i),[n("timeago",{staticClass:"time",attrs:{datetime:e.comment.createdAt,"auto-update":60}})],1)]}}])},[e._v(" "),n("span",[e._v(e._s(e._f("formatDate")(e.comment.createdAt,"DD. MMM h:mm A")))])]),e._v(" "),e.isActivityThread&&e.elementLabel?[n("v-divider",{attrs:{vertical:""}}),e._v(" "),n("editor-link",{attrs:{"activity-id":e.comment.activityId,"element-uid":e.elementUid,label:e.elementLabel}})]:e._e()],2)]),e._v(" "),e.showOptions?n("div",{staticClass:"actions"},e._l(e.options,(function(t,i){var a=t.action,r=t.icon,s=t.color;return n("v-btn",{key:i,staticClass:"ml-1",attrs:{"x-small":"",icon:""},on:{click:function(t){return e.$emit(a)}}},[n("v-icon",{attrs:{color:s,size:"14"}},[e._v(" mdi-"+e._s(r))])],1)})),1):e._e()],1)},staticRenderFns:[]},0,Y,"data-v-a1e0c4e8",!1),ee={name:"comment-preview",props:{content:{type:String,default:""},isResolved:{type:Boolean,default:!1}}};P(".content[data-v-3d625308]{margin-top:.375rem}.content pre[data-v-3d625308]{height:100%;margin:0;padding:0 .25rem .5rem 0;font:inherit;white-space:pre-wrap;word-break:break-all;word-wrap:break-word;overflow-wrap:break-word;background:inherit;border:none;overflow:hidden}.content.resolved[data-v-3d625308]{opacity:.7}.content.resolved .resolvement-options[data-v-3d625308]{display:flex;align-items:center;margin-bottom:.25rem;font-size:.75rem}");var te=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="Preview.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content",class:{resolved:e.isResolved}},[e.isResolved?n("div",{staticClass:"resolvement-options"},[n("span",{staticClass:"font-italic mr-1"},[e._v("Marked as resolved.")]),e._v(" "),n("v-tooltip",{attrs:{"open-delay":"800",right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({attrs:{color:"secondary",text:"","x-small":""},on:{click:e.$listeners.unresolve}},i),[e._v("\n          Undo\n        ")])]}}],null,!1,3181083862)},[e._v(" "),n("span",[e._v("Unresolve comment")])])],1):e._e(),e._v(" "),n("pre",[n("span",[e._v(e._s(e.content))]),n("br")])])},staticRenderFns:[]},0,ee,"data-v-3d625308",!1),ne={name:"thread-comment",props:{comment:{type:Object,required:!0},isActivityThread:{type:Boolean,default:!1},elementLabel:{type:String,default:null},user:{type:Object,required:!0}},data:function(e){return{content:e.comment.content,isEditing:!1}},computed:{isResolved:function(e){return!!e.comment.resolvedAt}},methods:{toggleEdit:function(){this.isEditing=!this.isEditing},save:function(){var e=this.comment,t=this.content;if(!t)return this.remove();this.toggleEdit(),this.$emit("update",e,t)},remove:function(){this.$emit("remove",this.comment)},reset:function(){this.content=this.comment.content,this.isEditing=!1}},watch:{comment:{deep:!0,handler:"reset"}},components:{CommentHeader:Z,CommentPreview:te}};P(".comment[data-v-3d04e7dc]{display:flex;flex-direction:column;font-family:Roboto,Arial,sans-serif}.comment-body[data-v-3d04e7dc]{flex:1;padding:0 .25rem 0 2.625rem}.comment-editor.v-textarea[data-v-3d04e7dc]{margin:.75rem 0 0 0}.comment-editor.v-textarea[data-v-3d04e7dc]  .v-input__slot{width:auto}");var ie=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="index.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"comment"},[n("comment-header",e._b({on:{toggleEdit:e.toggleEdit,remove:e.remove,resolve:function(t){return e.$emit("resolve",e.comment)}}},"comment-header",{comment:e.comment,isActivityThread:e.isActivityThread,isResolved:e.isResolved,elementLabel:e.elementLabel,user:e.user},!1)),e._v(" "),n("div",{staticClass:"comment-body"},[e.isEditing?[n("v-textarea",{staticClass:"comment-editor",attrs:{rows:"3",autofocus:"",outlined:"","auto-grow":"",clearable:"",counter:""},model:{value:e.content,callback:function(t){e.content="string"==typeof t?t.trim():t},expression:"content"}}),e._v(" "),n("span",{staticClass:"d-flex justify-end"},[n("v-btn",{attrs:{text:"",small:""},on:{click:e.reset}},[e._v("Cancel")]),e._v(" "),n("v-btn",{attrs:{color:"green",text:"",small:""},on:{click:e.save}},[n("v-icon",{staticClass:"pr-1"},[e._v("mdi-check")]),e._v(" Save\n        ")],1)],1)]:n("comment-preview",e._b({on:{unresolve:function(t){return e.$emit("unresolve",e.comment)}}},"comment-preview",{content:e.content,isResolved:e.isResolved},!1))],2)],1)},staticRenderFns:[]},0,ne,"data-v-3d04e7dc",!1),ae={name:"thread-list",inject:["$teRegistry"],props:{comments:{type:Array,default:function(){return[]}},isActivityThread:{type:Boolean,default:!1},elementLabel:{type:String,default:null},user:{type:Object,required:!0}},methods:{getElementLabel:function(e){var t,n=e.contentElement;if(n)return null===(t=I.default(this.$teRegistry._registry,{type:n.type}))||void 0===t?void 0:t.name}},components:{ThreadComment:ie}};P(".thread-list[data-v-b5620cec]{margin:0;padding:0;list-style:none}.thread-list .thread-list-item .v-divider[data-v-b5620cec]{margin:0 .25rem 1rem .25rem}.thread-list .thread-list-item:first-child .v-divider[data-v-b5620cec]{display:none}");var re=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="List.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"thread-list"},e._l(e.comments,(function(t){return n("li",{key:t.uid,staticClass:"thread-list-item"},[n("v-divider"),e._v(" "),n("thread-comment",e._g(e._b({staticClass:"mb-3",attrs:{"element-label":e.getElementLabel(t)}},"thread-comment",{comment:t,isActivityThread:e.isActivityThread,user:e.user},!1),e.$listeners))],1)})),0)},staticRenderFns:[]},0,ae,"data-v-b5620cec",!1),se={name:"unseen-divider",props:{count:{type:Number,required:!0}},computed:{unseenCommentsLabel:function(e){var t=e.count;return"".concat(t," new ").concat(D.default("message",t))}}};P(".unseen-divider[data-v-221b9d72]{text-align:center}.unseen-divider .v-divider[data-v-221b9d72]{margin:1rem 0 .25rem}.unseen-divider[data-v-221b9d72]  .v-chip.v-chip--outlined.v-chip{margin:-1.5rem 0 .5rem 0;border-radius:1rem!important;background-color:#fafafa!important}.unseen-divider[data-v-221b9d72]  .v-chip.v-chip--outlined.v-chip .v-chip__content .v-chip__close{margin-top:.125rem;font-size:.75rem!important}");var oe=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="UnseenDivider.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"unseen-divider"},[n("v-divider"),e._v(" "),n("v-chip",{attrs:{"close-icon":"mdi-close",color:"teal accent-4",outlined:"",small:"",close:""},on:{click:function(t){return e.$emit("seen")},"click:close":function(t){return e.$emit("seen")}}},[n("v-icon",{staticClass:"mr-1",attrs:{size:"14"}},[e._v("mdi-arrow-down")]),e._v(" "),n("span",{staticClass:"mr-2"},[e._v(e._s(e.unseenCommentsLabel))])],1)],1)},staticRenderFns:[]},0,se,"data-v-221b9d72",!1),de={name:"discussion-thread",props:{items:{type:Array,required:!0},showAll:{type:Boolean,default:!1},minDisplayed:{type:Number,default:5},isActivityThread:{type:Boolean,default:!1},unseenCount:{type:Number,required:!0},user:{type:Object,required:!0}},data:function(){return{isVisible:!1}},computed:{visibleComments:function(){var e=this.items,t=this.minDisplayed,n=this.showAll?e:F.default(e,t),i=J(S.default(n,"unseen"),2),a=i[0];return{seen:i[1],unseen:a}}},methods:{onUpdate:function(e,t){this.$emit("update",Object.assign({},e,{content:t}))},onIntersect:function(e,t,n){this.isVisible=n},revealUnseen:function(e){var t=this.$refs,n=this.minDisplayed;(e||this.unseenCount)<n||(this.$emit("showAll",!0),this.$nextTick((function(){var e=t.unseenDivider.$el;e&&e.scrollIntoView({behavior:"smooth"})})))},markSeen:function(){this.$emit("seen"),this.$emit("showAll",!1)}},watch:{isVisible:function(e){e&&this.unseenCount&&this.revealUnseen()},unseenCount:{immediate:!0,handler:"revealUnseen"}},components:{UnseenDivider:oe,ThreadList:re}};P(".discussion-thread[data-v-c6af8436]{width:100%}.discussion-thread.scroll-container[data-v-c6af8436]{max-height:31.25rem;overflow-y:scroll;overflow-x:hidden;padding-right:1.5rem;box-sizing:content-box}.discussion-thread .fade-enter-active[data-v-c6af8436],.discussion-thread .fade-leave-active[data-v-c6af8436]{transition:opacity .5s}.discussion-thread .fade-enter[data-v-c6af8436],.discussion-thread .fade-leave-to[data-v-c6af8436]{opacity:0}");var ce=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="index.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"intersect",rawName:"v-intersect",value:e.onIntersect,expression:"onIntersect"}],staticClass:"discussion-thread",class:{"scroll-container":!e.isActivityThread}},[n("thread-list",e._b({on:{update:e.onUpdate,remove:function(t){return e.$emit("remove",t)},resolve:function(t){return e.$emit("resolve",t)},unresolve:function(t){return e.$emit("unresolve",t)}}},"thread-list",{isActivityThread:e.isActivityThread,user:e.user,comments:e.visibleComments.seen},!1)),e._v(" "),n("transition",{attrs:{name:"fade"}},[e.unseenCount?n("unseen-divider",{ref:"unseenDivider",attrs:{count:e.unseenCount},on:{seen:e.markSeen}}):e._e()],1),e._v(" "),n("thread-list",e._b({on:{update:e.onUpdate,remove:function(t){return e.$emit("remove",t)},resolve:function(t){return e.$emit("resolve",t)},unresolve:function(t){return e.$emit("unresolve",t)}}},"thread-list",{isActivityThread:e.isActivityThread,user:e.user,comments:e.visibleComments.unseen},!1))],1)},staticRenderFns:[]},0,de,"data-v-c6af8436",!1);var le=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="ResolveButton.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"resolve-btn-container"},[n("v-tooltip",{attrs:{"open-delay":"800",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"px-1",attrs:{color:"teal accent-4",small:"",text:""}},Object.assign({},e.$listeners,i)),[n("v-icon",{staticClass:"mr-2",attrs:{size:"24",color:"teal accent-4"}},[e._v("\n          mdi-check-box-outline\n        ")]),e._v("\n        Resolve All\n      ")],1)]}}])},[e._v(" "),n("span",[e._v("Mark all as resolved and hide discussion")])])],1)},staticRenderFns:[]},0,{name:"resolve-comments-btn"},void 0,!1),ue={name:"embedded-discussion",inheritAttrs:!0,props:{comments:{type:Array,default:function(){return[]}},unseenComments:{type:Array,default:function(){return[]}},commentsShownLimit:{type:Number,default:5},scrollTarget:{type:String,default:"discussion"},showHeading:{type:Boolean,default:!1},showNotifications:{type:Boolean,default:!1},isActivityThread:{type:Boolean,default:!1},hasUnresolvedComments:{type:Boolean,default:!1},isVisible:{type:Boolean,default:!1},user:{type:Object,required:!0}},data:function(){return{showAll:!1,comment:{content:""}}},computed:{thread:function(){var e=this.comments,t=this.unseenComments,n=e.map((function(e){var n=t.find((function(t){return t.id===e.id}));return Object.assign({},e,{unseen:!!n})}));return O.default(n,["unseen","createdAt"],"asc")},commentsCount:function(e){return e.thread.length},hasHiddenComments:function(e){return e.commentsShownLimit<e.commentsCount},isTextEditorEmpty:function(e){var t;return!(null!==(t=e.comment.content)&&void 0!==t&&t.trim())},discussion:function(e){return e.$refs.discussion},commentInput:function(e){return e.$refs.commentInput},showResolveButton:function(e){return e.hasUnresolvedComments&&!e.isActivityThread}},methods:Object.assign({},v.mapRequests("app",["showConfirmationModal"]),{post:function(){var e=this,t=this.scrollTarget,n=this.comment,i=this.user;if(n.content){var a={content:n.content,author:i,createdAt:Date.now(),updatedAt:Date.now()};this.comment={content:""},this.$emit("save",a);var r={block:"center",behavior:"smooth"};this.$nextTick((function(){return e[t].scrollIntoView(r)}))}},remove:function(e){var t=this;this.showConfirmationModal(Object.assign({title:"Remove comment",message:"Are you sure you want to remove this comment?",action:function(){return t.$emit("remove",e)}},this.onConfirmationActive()))},resolveAll:function(){var e=this;this.showConfirmationModal(Object.assign({title:"Resolve all comments",message:"Are you sure you want to resolve all comments?",action:function(){return e.$emit("resolve")}},this.onConfirmationActive()))},onConfirmationActive:function(){var e=this;return{onOpen:function(){return e.$emit("update:confirmationActive",!0)},onClose:function(){return e.$emit("update:confirmationActive",!1)}}}}),watch:{commentsCount:function(){this.$emit("change",this.thread)},isVisible:{immediate:!0,handler:function(e){var t=this;!e&&this.isActivityThread||setTimeout((function(){return t.commentInput.focus()}),500)}}},created:function(){this.comment={content:""}},components:{DiscussionThread:ce,ResolveButton:le}};P(".embedded-discussion[data-v-a96888f8]{font-family:Roboto,Arial,sans-serif}.embedded-discussion .resolve-btn-container[data-v-a96888f8]{display:flex;justify-content:flex-end;margin:.5rem 0 0 0}.embedded-discussion .header[data-v-a96888f8]{margin:.875rem 0 1.625rem 0;font-size:1.125rem;font-weight:400}.embedded-discussion .comment-input[data-v-a96888f8]{margin:0 .25rem 0 .25rem}.embedded-discussion .alert[data-v-a96888f8]  .v-icon{color:var(--v-primary-darken2)!important}");var me=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="index.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"discussion",staticClass:"embedded-discussion"},[e.showResolveButton?n("resolve-button",{on:{click:e.resolveAll}}):e._e(),e._v(" "),n("div",{class:{"pb-7":!e.showHeading&&e.hasHiddenComments}},[e.hasHiddenComments?n("v-btn",{staticClass:"float-right mt-1",attrs:{text:"","x-small":""},on:{click:function(t){e.showAll=!e.showAll}}},[e._v("\n      Show "+e._s(e.showAll?"less":"more")+"\n    ")]):e._e()],1),e._v(" "),e.showHeading?n("div",{staticClass:"header d-flex grey--text text--darken-3"},[n("v-icon",{staticClass:"mr-2",attrs:{color:"grey darken-3"}},[e._v("\n      mdi-forum-outline\n    ")]),e._v("\n    Comments\n  ")],1):e._e(),e._v(" "),!e.commentsCount&&e.showNotifications?n("v-alert",{staticClass:"alert",attrs:{color:"primary lighten-5",icon:"mdi-keyboard-outline",prominent:""}},[n("span",{staticClass:"px-1 subtitle-2"},[e._v("\n      Be the First to Comment!\n    ")])]):e._e(),e._v(" "),e.thread.length?n("discussion-thread",{staticClass:"mt-2",attrs:{items:e.thread,"show-all":e.showAll,"min-displayed":e.commentsShownLimit,"is-activity-thread":e.isActivityThread,"unseen-count":e.unseenComments.length,user:e.user},on:{update:function(t){return e.$emit("update",t)},resolve:function(t){return e.$emit("resolve",t)},unresolve:function(t){return e.$emit("unresolve",t)},seen:function(t){return e.$emit("seen")},remove:e.remove,showAll:function(t){e.showAll=t}}}):e._e(),e._v(" "),n("div",{staticClass:"text-right"},[n("v-textarea",{ref:"commentInput",staticClass:"comment-input",attrs:{placeholder:e.commentsCount?"Add a comment...":"Start the discussion...",rows:"3",outlined:"","auto-grow":"",clearable:"",counter:""},on:{focus:function(t){return e.$emit("seen")}},model:{value:e.comment.content,callback:function(t){e.$set(e.comment,"content","string"==typeof t?t.trim():t)},expression:"comment.content"}}),e._v(" "),n("v-btn",{attrs:{disabled:e.isTextEditorEmpty,icon:""},on:{click:e.post}},[n("v-icon",[e._v("mdi-send")])],1)],1)],1)},staticRenderFns:[]},0,ue,"data-v-a96888f8",!1),ve={name:"element-discussion",props:{id:{type:Number,default:null},uid:{type:String,required:!0},comments:{type:Array,required:!0},hasUnresolvedComments:{type:Boolean,default:!1},lastSeen:{type:Number,required:!0},user:{type:Object,required:!0}},data:function(){return{isVisible:!1,isConfirmationActive:!1}},computed:Object.assign({},v.mapChannels({editorBus:"editor"}),{events:function(){return n.Events.Discussion},lastCommentAt:function(e){return new Date(T.default(e.comments[0],"createdAt",0)).getTime()},unseenComments:function(){var e=this.comments,t=this.user,n=this.lastSeen;return e.filter((function(e){var i=new Date(e.createdAt).getTime();return e.author.id!==t.id&&i>n}))},activator:function(){var e=this.comments,t=this.unseenComments,n=t.length?"unseen":e.length?"preview":"post";return function(e){return{unseen:{class:"teal accent-4 white--text",tooltip:"View new comments",text:e.length},preview:{icon:"mdi-comment-text-multiple-outline",color:"primary darken-4",tooltip:"View comments"},post:{icon:"mdi-message-plus-outline",color:"primary darken-4",tooltip:"Post a comment"}}}(t)[n]}}),methods:{save:function(e){var t=this.user,i=this.id,a=this.hasUnresolvedComments;return this.editorBus.emit(n.Events.Discussion.SAVE,Object.assign({},e,{author:t,contentElementId:i,hasUnresolvedComments:a}))},setLastSeen:function(e){var t=this.uid,n=this.lastCommentAt,i=this.events,a={elementUid:t,lastCommentAt:n,timeout:e};this.editorBus.emit(i.SET_LAST_SEEN,a)},resolve:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.resolvedAt,i=this.id,a=this.events;this.editorBus.emit(a.RESOLVE,{id:t,contentElementId:i,resolvedAt:n})}},watch:{isVisible:function(e){this.$emit(e?"open":"close")}},components:{Discussion:me}};P("[data-v-32a30371] .v-menu__content{background:#fff}[data-v-32a30371] .v-menu__content .embedded-discussion{text-align:left}[data-v-32a30371] .v-menu__content .comment .author{font-size:.875rem}.unseen[data-v-32a30371]{font-size:.75rem}");var fe=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="ElementDiscussion.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-menu",{attrs:{"close-on-content-click":!1,"close-on-click":!e.isConfirmationActive,"min-width":"300",transition:"slide-y-transition",left:"","offset-y":"",attach:""},nativeOn:{click:function(e){e.stopPropagation()}},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-tooltip",{attrs:{"open-delay":"800",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[n("v-btn",e._g({class:e.activator.class,attrs:{"x-small":"",icon:""}},Object.assign({},i,a)),[e.activator.text?n("div",{staticClass:"unseen"},[e._v(e._s(e.activator.text))]):n("v-icon",{attrs:{color:e.activator.color,size:"18"}},[e._v("\n            "+e._s(e.activator.icon)+"\n          ")])],1)]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(e.activator.tooltip))])])]}}]),model:{value:e.isVisible,callback:function(t){e.isVisible=t},expression:"isVisible"}},[e._v(" "),n("discussion",e._b({staticClass:"pa-2",attrs:{"confirmation-active":e.isConfirmationActive},on:{save:e.save,update:e.save,remove:function(t){return e.editorBus.emit(e.events.REMOVE,t)},seen:e.setLastSeen,resolve:e.resolve,"update:confirmationActive":function(t){e.isConfirmationActive=t},"update:confirmation-active":function(t){e.isConfirmationActive=t}}},"discussion",{comments:e.comments,unseenComments:e.unseenComments,hasUnresolvedComments:e.hasUnresolvedComments,user:e.user,isVisible:e.isVisible},!1))],1)},staticRenderFns:[]},0,ve,"data-v-32a30371",!1);var pe=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="PublishDiffChip.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this.$createElement,t=this._self._c||e;return this.changeType?t("v-chip",{staticClass:"readonly font-weight-medium text-capitalize",attrs:{"text-color":"new"===this.changeType?"success":"secondary",color:"primary lighten-5",small:"",round:""}},[this._v("\n  "+this._s(this.changeType)+"\n")]):this._e()},staticRenderFns:[]},0,{name:"publish-diff-chip",props:{changeType:{validator:function(e){return!e||Object.values(n.publishDiffChangeTypes).includes(e)},default:null}}},void 0,!1),he={name:"content-element",inject:{$getCurrentUser:{},$editorState:{default:{}}},inheritAttrs:!1,props:{element:{type:Object,required:!0},parent:{type:Object,default:null},isHovered:{type:Boolean,default:!1},isDragged:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1},frame:{type:Boolean,default:!0},dense:{type:Boolean,default:!1},showDiscussion:{type:Boolean,default:!1}},data:function(){return{isFocused:!1,isSaving:!1,activeUsers:[]}},computed:Object.assign({},v.mapChannels({editorBus:"editor"}),{id:function(e){return n.getElementId(e.element)},componentName:function(e){return n.getComponentName(e.element.type)},isEmbed:function(e){return!!e.parent||!e.element.uid},isHighlighted:function(e){return e.isFocused||e.isHovered},hasComments:function(e){var t;return!(null===(t=e.element.comments)||void 0===t||!t.length)},elementBus:function(e){return e.$radio.channel("element:".concat(e.id))},currentUser:function(e){return e.$getCurrentUser()}}),methods:{onSelect:function(e){this.isDisabled||this.$editorState.isPublishDiff||e.component||(this.focus(),e.component={name:"content-element",data:this.element})},onSave:function(e){this.isEmbed||(this.isSaving=!0),this.$emit("save",e)},focus:function(){this.editorBus.emit("element:focus",this.element,this.parent)}},created:function(){var e=this;this.elementBus.on("delete",(function(){return e.$emit("delete")})),this.elementBus.on("save:meta",(function(t){return e.$emit("save:meta",t)})),this.elementBus.on("saved",(function(){return setTimeout((function(){return e.isSaving=!1}),1e3)})),this.editorBus.on("element:select",(function(t){var n=t.elementId,i=t.isSelected,a=void 0===i||i,r=t.user;if(e.id===n)return r&&r.id!==e.currentUser.id?void(a&&!e.activeUsers.find((function(e){return e.id===r.id}))?e.activeUsers.push(r):!a&&e.activeUsers.find((function(e){return e.id===r.id}))&&(e.activeUsers=e.activeUsers.filter((function(e){return e.id!==r.id})))):(e.isFocused=a,void(a&&e.focus()))})),this.editorBus.on("element:focus",(function(t){e.isFocused=!!t&&n.getElementId(t)===e.id}))},provide:function(){return{$elementBus:this.elementBus}},components:{ActiveUsers:N,Discussion:fe,PublishDiffChip:pe}};P(".content-element[data-v-3d2ab02a]{position:relative;border:1px solid transparent}.content-element[data-v-3d2ab02a]::after{content:'';display:none;position:absolute;top:0;right:-.125rem;width:.125rem;height:100%}.content-element.focused[data-v-3d2ab02a]{border:1px dashed #1de9b6}.content-element.focused[data-v-3d2ab02a]::after{display:block;background:#1de9b6}.content-element.selected[data-v-3d2ab02a]{border:1px dashed #ff4081}.content-element.selected[data-v-3d2ab02a]::after{display:block;background:#ff4081}.frame[data-v-3d2ab02a]{padding:10px 20px;border:1px solid #e1e1e1}.element-actions[data-v-3d2ab02a]{display:flex;flex-direction:column;position:absolute;top:-.0625rem;right:-1.25rem;width:1.5rem;height:100%;padding-left:.75rem}.element-actions>*[data-v-3d2ab02a]{min-height:1.75rem;opacity:0;transition:opacity .1s linear}.element-actions>.is-visible[data-v-3d2ab02a]{opacity:1;transition:opacity .5s linear}.active-users[data-v-3d2ab02a]{position:absolute;top:0;left:-1.625rem}.save-indicator[data-v-3d2ab02a]{position:absolute;bottom:-.125rem;left:0}.header[data-v-3d2ab02a]{width:100%;max-height:0}.header.visible[data-v-3d2ab02a]{max-height:unset;padding:0 0 .5rem}.diff.new[data-v-3d2ab02a]{border:none;box-shadow:0 0 0 2px var(--v-success-lighten2)!important}.diff.changed[data-v-3d2ab02a],.diff.removed[data-v-3d2ab02a]{border:none;box-shadow:0 0 0 2px var(--v-secondary-lighten4)!important}.diff .element-actions[data-v-3d2ab02a]{display:none}");var ye=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="ContentElement.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-element",class:[e.element.changeSincePublish,{selected:e.activeUsers.length,focused:e.isFocused,diff:e.$editorState.isPublishDiff,frame:e.frame}],on:{click:e.onSelect}},[n("div",{staticClass:"header d-flex",class:{visible:e.$editorState.isPublishDiff&&e.element.changeSincePublish}},[n("publish-diff-chip",{staticClass:"ml-auto ",attrs:{"change-type":e.element.changeSincePublish}})],1),e._v(" "),n("active-users",{staticClass:"active-users",attrs:{users:e.activeUsers,size:20}}),e._v(" "),n(e.componentName,e._b({tag:"component",attrs:{id:"element_"+e.id},on:{add:function(t){return e.$emit("add",t)},save:e.onSave,delete:function(t){return e.$emit("delete")},focus:e.onSelect}},"component",Object.assign({},e.$attrs,{element:e.element,isFocused:e.isFocused,isDragged:e.isDragged,isDisabled:e.isDisabled,dense:e.dense}),!1)),e._v(" "),e.isDisabled?e._e():n("div",{staticClass:"element-actions"},[e.showDiscussion?n("div",{class:{"is-visible":e.isHighlighted||e.hasComments}},[n("discussion",e._b({attrs:{user:e.currentUser},on:{open:e.focus,close:function(t){e.isFocused=!1}}},"discussion",e.element,!1))],1):e._e(),e._v(" "),e.parent?e._e():n("div",{class:{"is-visible":e.isHighlighted}},[n("v-btn",{attrs:{color:"pink lighten-1",dark:"",icon:"","x-small":""},on:{click:function(t){return e.$emit("delete")}}},[n("v-icon",{attrs:{size:"20"}},[e._v("mdi-delete-outline")])],1)],1)]),e._v(" "),e.isSaving?n("v-progress-linear",{staticClass:"save-indicator",attrs:{height:"2",color:"teal accent-2",indeterminate:""}}):e._e()],1)},staticRenderFns:[]},0,he,"data-v-3d2ab02a",!1),be={name:"contained-content",inheritAttrs:!1,props:{element:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},isDragged:{type:Boolean,default:!1},setWidth:{type:Boolean,default:!0},dense:{type:Boolean,default:!1}},data:function(){return{isHovered:!1}},computed:{bindings:function(){var e=this.element,t=this.isDisabled,n=this.isDragged,i=this.isHovered,a=this.dense,r=this.$attrs;return Object.assign({element:e,isDisabled:t,isDragged:n,isHovered:i,dense:a},r)},widthClass:function(){var e=this.element;return this.setWidth?"col-xs-".concat(T.default(e,"data.width",12)):""}},methods:{scrollContainer:B.default((function(e){var t=e.y<200,n=e.y>window.innerHeight-200;(t||n)&&window.scrollBy(0,t?-30:30)}),20)},components:{ContentElement:ye}};P(".drag-handle[data-v-eb67dfae]{position:absolute;left:-3px;z-index:2;width:26px;opacity:0}.drag-handle .mdi[data-v-eb67dfae]{color:#888;font-size:28px}.hovered .drag-handle[data-v-eb67dfae]{opacity:1;transition:opacity .6s ease-in-out;cursor:pointer}.disabled .drag-handle[data-v-eb67dfae]{display:none}.contained-content[data-v-eb67dfae]{position:relative;margin:7px 0;padding:0}");var ge=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="ContainedContent.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"contained-content",class:[e.widthClass,{disabled:e.isDisabled,hovered:e.isHovered}],on:{mouseover:function(t){e.isHovered=!0},mouseleave:function(t){e.isHovered=!1},dragstart:function(t){return e.$emit("dragstart")},dragend:function(t){return e.$emit("dragend")},dragover:e.scrollContainer}},[e.isDisabled?e._e():n("span",{staticClass:"drag-handle"},[n("span",{staticClass:"mdi mdi-drag-vertical"})]),e._v(" "),n("content-element",e._b({on:{add:function(t){return e.$emit("add",t)},save:function(t){return e.$emit("save",t)},"save:meta":function(t){return e.$emit("save:meta",t)},delete:function(t){return e.$emit("delete")}}},"content-element",e.bindings,!1))],1)},staticRenderFns:[]},0,be,"data-v-eb67dfae",!1),_e={name:"element-list",props:{elements:{type:Array,default:function(){return[]}},dragOptions:{type:Object,default:function(){return{}}},supportedTypes:{type:Array,default:null},activity:{type:Object,default:null},layout:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1},enableAdd:{type:Boolean,default:!0},addElementOptions:{type:Object,default:function(){return{}}}},data:function(){return{dragElementIndex:null}},computed:Object.assign({},v.mapChannels({editorChannel:"editor"}),{options:function(e){return Object.assign({},e.dragOptions,{handle:".drag-handle"})}}),methods:{get:T.default,getElementId:n.getElementId,onDragStart:function(e){this.dragElementIndex=e,this.editorChannel.emit("element:focus")},onDragEnd:function(e){this.dragElementIndex=-1,this.editorChannel.emit("element:focus",e)},reorder:function(e){var t=e.newIndex,n=this.elements;this.$emit("update",{newPosition:t,items:n})}},components:{AddElement:Q,Draggable:j.default}};P(".list-group[data-v-5e5c4768]{padding:.625rem 1.5rem}[data-v-5e5c4768] .sortable-ghost .drag-handle{display:none}[data-v-5e5c4768] .sortable-ghost .content-element{max-height:9.375rem;background:#f4f5f5}[data-v-5e5c4768] .sortable-ghost .content-element>*{visibility:hidden}[data-v-5e5c4768] .sortable-drag .content-element{max-height:auto;background:#fff}");var Ce=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="ElementList.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"list-group"},[n("draggable",e._b({staticClass:"row",attrs:{list:e.elements,disabled:e.isDisabled},on:{start:function(t){e.dragElementIndex=t.oldIndex},end:function(t){e.dragElementIndex=-1},update:e.reorder}},"draggable",e.options,!1),e._l(e.elements,(function(t,i){return n("div",{key:e.getElementId(t),staticClass:"pr-5",class:"col-xs-"+e.get(t,"data.width",12),on:{dragstart:function(t){return e.onDragStart(i)},dragend:function(n){return e.onDragEnd(t)}}},[e._t("list-item",null,{element:t,isDragged:e.dragElementIndex===i,position:i})],2)})),0),e._v(" "),e.enableAdd&&!e.isDisabled?[e._t("list-add",[n("add-element",{staticClass:"mt-1",attrs:{items:e.elements,include:e.supportedTypes,activity:e.activity,label:e.addElementOptions.label,large:e.addElementOptions.large,position:e.elements.length,layout:e.layout},on:{add:function(t){return e.$emit("add",t)}}})],{include:e.supportedTypes,activity:e.activity,position:e.elements.length,layout:e.layout})]:e._e()],2)},staticRenderFns:[]},0,_e,"data-v-5e5c4768",!1);var we=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="ElementPlaceholder.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-sheet",{staticClass:"transparent grey--text text--darken-4",class:e.dense?"pt-3":"pa-12"},[n("v-avatar",{attrs:{size:e.dense?40:60,color:e.isDisabled?"grey darken-3":"primary darken-4"}},[n("v-icon",{attrs:{size:e.iconSize,color:e.isFocused?e.activeColor:"#fff"}},[e._v("\n      "+e._s(e.icon)+"\n    ")])],1),e._v(" "),n("div",{staticClass:"grey--text",class:[e.isDisabled?"text--darken-3":"text--darken-4",e.dense?"my-2 subtitle-2":"my-4 headline"]},[e._v("\n    "+e._s(e.name)+"\n  ")]),e._v(" "),e.dense||e.isDisabled?e._e():n("div",{staticClass:"subtitle-1"},[e.isFocused?[n("span",[e._v(e._s(e.activePlaceholder))]),e._v(" "),e.activeIcon?n("v-icon",{attrs:{size:"20",color:"primary darken-4"}},[e._v("\n        "+e._s(e.activeIcon)+"\n      ")]):e._e()]:[e._v(e._s(e.placeholder))]],2)],1)},staticRenderFns:[]},0,{name:"element-placeholder",props:{name:{type:String,required:!0},icon:{type:String,required:!0},placeholder:{type:String,default:"Select to edit"},activePlaceholder:{type:String,default:"Use toolbar to edit"},activeIcon:{type:String,default:null},activeColor:{type:String,default:"#fff"},isDisabled:{type:Boolean,default:!1},isFocused:{type:Boolean,default:!1},dense:{type:Boolean,default:!1}},computed:{iconSize:function(){return this.dense?this.isFocused?24:20:this.isFocused?38:30}}},void 0,!1);var xe=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="EmbeddedContainer.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("element-list",{attrs:{"add-element-options":e.addElementOptions,elements:e.embeds,"supported-types":e.types,"enable-add":!e.isDisabled&&e.enableAdd},on:{add:e.addItems,update:e.reorderItem},scopedSlots:e._u([{key:"list-item",fn:function(t){var i=t.element,a=t.isDragged;return[n("contained-content",e._b({staticClass:"my-2",attrs:{element:i,"is-dragged":a,"is-disabled":e.isDisabled},on:{save:function(t){return e.save(i,"data",t)},"save:meta":function(t){return e.save(i,"meta",t)},delete:function(t){return e.requestDeleteConfirmation(i)}}},"contained-content",e.$attrs,!1))]}}])})},staticRenderFns:[]},0,{name:"embedded-container",inheritAttrs:!1,props:{container:{type:Object,required:!0},types:{type:Array,default:function(){return["JODIT_HTML","IMAGE","HTML","VIDEO"]}},isDisabled:{type:Boolean,default:!1},addElementOptions:{type:Object,default:function(){return{}}},enableAdd:{type:Boolean,default:!0}},computed:{embeds:function(){var e=this.container.embeds;return e?z.default(e).sort((function(e,t){return e.position-t.position})):[]}},methods:Object.assign({},v.mapRequests("app",["showConfirmationModal"]),{addItems:function(e){e=Array.isArray(e)?e:[e];var t=q.default(this.container);t.embeds=Object.assign({},t.embeds,U.default(e,"id")),this.$emit("save",t)},reorderItem:function(e){var t=e.newPosition,i=e.items,a={items:i,newPosition:t},r=q.default(this.container);r.embeds[i[t].id].position=n.calculatePosition(a),this.$emit("save",r)},save:function(e,t,n){var i=q.default(this.container);i.embeds[e.id]=Object.assign({},e,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,n)),this.$emit("save",i)},requestDeleteConfirmation:function(e){var t=this;this.showConfirmationModal({title:"Delete element?",message:"Are you sure you want to delete element?",action:function(){return t.$emit("delete",e)}})}}),components:{ContainedContent:ge,ElementList:Ce}},void 0,!1),Ee={name:"inline-activator",inheritAttrs:!1,props:{disabled:{type:Boolean,required:!1}}};P(".default-activator-state[data-v-32cc672a],.inline-activator[data-v-32cc672a],.inline-activator.disabled[data-v-32cc672a],.inline-activator.disabled[data-v-32cc672a]:hover{padding:0 3.125rem;opacity:0}.inline-activator[data-v-32cc672a]{display:flex;align-items:center;width:100%;margin:0;padding:0 3.125rem;opacity:0;transition:opacity .3s,padding .3s}.inline-activator[data-v-32cc672a],.inline-activator .v-chip[data-v-32cc672a]{cursor:pointer}.inline-activator hr[data-v-32cc672a]{flex:1;display:inline-flex;margin:0;border-top:.0625rem dashed var(--v-primary-darken3)}.inline-activator[data-v-32cc672a]:focus,.inline-activator[data-v-32cc672a]:hover{padding:.75rem 0;opacity:1;outline:0;transition:opacity .3s .25s,padding .3s .1s}.inline-activator.disabled[data-v-32cc672a],.inline-activator.disabled[data-v-32cc672a]:hover{pointer-events:none}");var Ae=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="InlineActivator.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this.$createElement,t=this._self._c||e;return t("button",this._g({staticClass:"inline-activator",class:{disabled:this.disabled}},this.$listeners),[t("hr"),this._v(" "),t("v-avatar",{attrs:{size:"20",color:"primary darken-4"}},[t("v-icon",{attrs:{size:"16",dark:""}},[this._v("mdi-plus")])],1),this._v(" "),t("hr")],1)},staticRenderFns:[]},0,Ee,"data-v-32cc672a",!1),ke={props:{error:{type:String,default:""}}};P(".input-error[data-v-33d55bb8]{color:var(--v-error-base);font-size:.75rem}");var Re=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="InputError.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this.$createElement,t=this._self._c||e;return t("transition",{attrs:{name:"message-transition"}},[this.error?t("div",{staticClass:"input-error"},[this._v("\n    "+this._s(this.error)+"\n  ")]):this._e()])},staticRenderFns:[]},0,ke,"data-v-33d55bb8",!1),$e={name:"tce-preview-overlay",props:{show:{type:Boolean,default:!1}}};P(".message[data-v-4e41c6e0]{border-radius:2px;font-size:1.125rem}");var Se=function(e,t,n,i,a,r,s,o){var d=("function"==typeof n?n.options:n)||{};return d.__file="PreviewOverlay.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),d._scopeId=i,d}({render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-overlay",{attrs:{value:this.show,opacity:"0.9",absolute:""}},[t("button",{staticClass:"message pa-2 grey--text text--lighten-2"},[this._t("default",[this._v("Click to preview")])],2)])},staticRenderFns:[]},0,$e,"data-v-4e41c6e0",!1);e.ActiveUsers=N,e.AddElement=Q,e.ContainedContent=ge,e.ContentElement=ye,e.Discussion=me,e.ElementList=Ce,e.ElementPlaceholder=we,e.EmbeddedContainer=xe,e.InlineActivator=Ae,e.InputError=Re,e.PreviewOverlay=Se,e.PublishDiffChip=pe,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=tce-components.umd.min.js.map
