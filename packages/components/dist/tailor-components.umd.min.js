!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash/capitalize"),require("@tailor/utils"),require("lodash/filter"),require("lodash/flatMap"),require("lodash/intersection"),require("lodash/pick"),require("lodash/reduce"),require("lodash/reject"),require("@tailor/api"),require("lodash/partition"),require("lodash/takeRight"),require("lodash/find"),require("pluralize"),require("@extensionengine/vue-radio"),require("lodash/orderBy"),require("lodash/get"),require("lodash/keyBy"),require("lodash/map"),require("lodash/groupBy"),require("lodash/debounce"),require("lodash/sortBy"),require("lodash/throttle"),require("vuedraggable"),require("lodash/cloneDeep"),require("lodash/mapKeys"),require("lodash/values"),require("lodash/last"),require("lodash/uniqueId")):"function"==typeof define&&define.amd?define(["exports","lodash/capitalize","@tailor/utils","lodash/filter","lodash/flatMap","lodash/intersection","lodash/pick","lodash/reduce","lodash/reject","@tailor/api","lodash/partition","lodash/takeRight","lodash/find","pluralize","@extensionengine/vue-radio","lodash/orderBy","lodash/get","lodash/keyBy","lodash/map","lodash/groupBy","lodash/debounce","lodash/sortBy","lodash/throttle","vuedraggable","lodash/cloneDeep","lodash/mapKeys","lodash/values","lodash/last","lodash/uniqueId"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TailorComponents={},e.capitalize,e.utils,e.filter,e.flatMap,e.intersection,e.pick,e.reduce,e.reject,e.api,e.partition,e.takeRgt,e.find,e.pluralize,e.vueRadio,e.orderBy,e.get,e.keyBy,e.map,e.groupBy,e.debounce,e.sortBy,e.throttle,e.Draggable,e.cloneDeep,e.mapKeys,e.values,e.last,e.uniqueId)}(this,(function(e,t,n,i,r,a,s,o,l,d,c,u,m,v,f,p,h,y,g,b,_,C,w,x,E,k,R,A,S){"use strict";function $(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var F=$(t),I=$(i),T=$(r),B=$(a),D=$(s),O=$(o),j=$(l),q=$(c),U=$(u),L=$(m),P=$(v),z=$(p),N=$(h),M=$(y),V=$(g),H=$(b),W=$(_),K=$(C),Q=$(w),J=$(x),G=$(E),X=$(k),Y=$(R),Z=$(A),ee=$(S),te={name:"tailor-active-users",props:{users:{type:Array,default:function(){return[]}},size:{type:Number,default:36}},filters:{capitalize:F.default}};function ne(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}ne(".avatar[data-v-33d463d4]{transition:all .2s}.avatar img[data-v-33d463d4]{padding:.125rem}.avatar[data-v-33d463d4]:focus-within,.avatar[data-v-33d463d4]:hover{transform:scale(1.1);z-index:1}.avatar:focus-within img[data-v-33d463d4]:focus,.avatar:hover img[data-v-33d463d4]:focus{outline:0}");var ie=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="ActiveUsers.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"d-flex align-center"},e._l(e.users,(function(t){var i=t.id,r=t.label,a=t.imgUrl;return n("v-avatar",{key:i,staticClass:"avatar",attrs:{size:e.size,color:"pink accent-2"}},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a?n("img",e._g({attrs:{src:a,alt:r,"aria-describedby":"activeUser-"+i,tabindex:"0"}},s)):e._e()]}}],null,!0)},[e._v(" "),n("span",{attrs:{id:"activeUser-"+i}},[e._v(e._s(r))])])],1)})),1)},staticRenderFns:[]},0,te,"data-v-33d463d4",!1),re={name:"add-new-element",props:{library:{type:Array,required:!0},allowedTypes:{type:Array,required:!0}},methods:{isAllowed:function(e){return!this.allowedTypes.length||this.allowedTypes.includes(e)}}};ne(".element-container[data-v-5e4d908e]{min-height:20rem;padding:0 0 1.875rem;border-top-left-radius:.5rem;border-top-right-radius:.5rem;overflow:hidden}.group-heading[data-v-5e4d908e]{margin:0 2.5rem .375rem;padding-top:.5rem;font-size:.875rem;font-weight:500;line-height:1rem;text-align:left}.group-elements[data-v-5e4d908e]{display:flex;flex-wrap:wrap;width:100%;padding:0 1.875rem}.add-element[data-v-5e4d908e]{width:8.125rem;min-width:8.125rem;height:auto!important;min-height:4.375rem;padding:0!important;white-space:normal}.add-element[data-v-5e4d908e]  .v-btn__content{flex:1 1 100%;flex-direction:column;padding:.375rem;text-transform:none}.add-element .v-icon[data-v-5e4d908e]{padding:.125rem 0;font-size:1.875rem}.add-element .button-text[data-v-5e4d908e]{margin:.625rem 0}");var ae=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="AddNewElement.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-bottom-sheet",e._g(e._b({attrs:{"max-width":"1240",inset:""}},"v-bottom-sheet",e.$attrs,!1),e.$listeners),[n("div",{staticClass:"element-container grey lighten-5"},[n("div",{staticClass:"d-flex align-center py-4 px-10"},[e._t("header")],2),e._v(" "),e._l(e.library,(function(t){return n("div",{key:t.name},[n("div",{staticClass:"group-heading grey--text text--darken-4"},[e._v(e._s(t.name))]),e._v(" "),n("div",{staticClass:"group-elements"},e._l(t.elements,(function(t){return n("v-hover",{key:t.position,scopedSlots:e._u([{key:"default",fn:function(i){var r=i.hover;return[n("v-btn",{staticClass:"add-element",attrs:{disabled:!e.isAllowed(t.type),color:r?"secondary accent-2":"blue-grey darken-4",text:""},on:{click:function(n){return n.stopPropagation(),e.$emit("add",[t])}}},[t.ui.icon?n("v-icon",{attrs:{size:"26",color:"primary darken-3"}},[e._v("\n              "+e._s(t.ui.icon)+"\n            ")]):e._e(),e._v(" "),n("span",{staticClass:"button-text body-2"},[e._v(e._s(t.name))])],1)]}}],null,!0)})})),1)])}))],2)])},staticRenderFns:[]},0,re,"data-v-5e4d908e",!1);function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{i||null==o.return||o.return()}finally{if(r)throw a}}return n}(e,t)||le(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e){return function(e){if(Array.isArray(e))return de(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||le(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){if(e){if("string"==typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?de(e,t):void 0}}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ce=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="EditorLink.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editor-link"},[n("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("router-link",{attrs:{to:e.editorRoute},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.navigate,a=t.isExactActive;return[n("v-btn",e._g(e._b({attrs:{color:a?"teal accent-4":"primary",text:"","x-small":""},on:{click:r}},"v-btn",e.$attrs,!1),i),[e._v("\n          "+e._s(e.label)+"\n          "),e._t("icon",[n("v-icon",{staticClass:"ml-1",attrs:{"x-small":""}},[e._v("mdi-arrow-top-right-thick")])])],2)]}}],null,!0)})]}}])},[e._v(" "),e._t("tooltip",[n("span",[e._v("View element")])])],2)],1)},staticRenderFns:[]},0,{name:"tailor-editor-link",props:{activityId:{type:Number,required:!0},elementUid:{type:String,default:null},label:{type:String,required:!0}},computed:{editorRoute:function(e){var t=e.activityId,n=e.elementUid;return Object.assign({name:"editor",params:{activityId:t}},n&&{query:{elementId:n}})}}},void 0,!1),ue={name:"comment-header",props:{comment:{type:Object,required:!0},isActivityThread:{type:Boolean,default:!1},isResolved:{type:Boolean,default:!1},elementLabel:{type:String,default:null},user:{type:Object,required:!0}},computed:{elementUid:function(e){return e.comment.contentElement.uid},author:function(e){return e.comment.author},isAuthor:function(e){return e.author.id===e.user.id},isDeleted:function(e){return!!e.comment.deletedAt},showEditedLabel:function(e){return!!e.comment.editedAt},showOptions:function(e){return e.isAuthor&&!e.isDeleted&&!e.isResolved},options:function(){var e={resolve:{action:"resolve",icon:"check-box-outline",color:"teal accent-4"},edit:{action:"toggleEdit",icon:"pencil-outline",color:"grey"},remove:{action:"remove",icon:"trash-can-outline",color:"grey"}};return this.isActivityThread&&delete e.resolve,e}},components:{EditorLink:ce}};ne(".header[data-v-a1e0c4e8]{display:flex;align-items:flex-start}.header .comment-avatar[data-v-a1e0c4e8]{margin:.375rem .375rem 0 0}.header .info-container[data-v-a1e0c4e8]{display:flex;flex-direction:column;flex:0 100%;max-width:calc(100% - 8rem);margin-left:.125rem}.header .info-container .author[data-v-a1e0c4e8]{display:inline-block;max-width:75%;color:#000;font-size:1rem}.header .info-container .edited[data-v-a1e0c4e8],.header .info-container .time[data-v-a1e0c4e8]{color:#888;font-size:.75rem}.header .info-container hr.v-divider--vertical[data-v-a1e0c4e8]{margin:.25rem .125rem .125rem .625rem}.header .info-container[data-v-a1e0c4e8]  .editor-link{display:inline-flex;align-self:flex-end}.header .actions[data-v-a1e0c4e8]{margin-left:auto}");var me=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="Header.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header"},[n("v-avatar",{staticClass:"comment-avatar",attrs:{size:"34"}},[n("img",{attrs:{src:e.author.imgUrl}})]),e._v(" "),n("div",{staticClass:"info-container"},[n("div",{staticClass:"d-flex align-center"},[n("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({staticClass:"author text-truncate"},i),[e._v(e._s(e.author.label))])]}}])},[e._v("\n        "+e._s(e.author.label)+"\n      ")]),e._v(" "),e.showEditedLabel?n("span",{staticClass:"edited ml-1"},[e._v("(edited)")]):e._e()],1),e._v(" "),n("div",{staticClass:"d-flex align-center"},[n("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("span",e._g({},i),[n("timeago",{staticClass:"time",attrs:{datetime:e.comment.createdAt,"auto-update":60}})],1)]}}])},[e._v(" "),n("span",[e._v(e._s(e._f("formatDate")(e.comment.createdAt,"DD. MMM h:mm A")))])]),e._v(" "),e.isActivityThread&&e.elementLabel?[n("v-divider",{attrs:{vertical:""}}),e._v(" "),n("editor-link",{attrs:{"activity-id":e.comment.activityId,"element-uid":e.elementUid,label:e.elementLabel}})]:e._e()],2)]),e._v(" "),e.showOptions?n("div",{staticClass:"actions"},e._l(e.options,(function(t,i){var r=t.action,a=t.icon,s=t.color;return n("v-btn",{key:i,staticClass:"ml-1",attrs:{"x-small":"",icon:""},on:{click:function(t){return e.$emit(r)}}},[n("v-icon",{attrs:{color:s,size:"14"}},[e._v(" mdi-"+e._s(a))])],1)})),1):e._e()],1)},staticRenderFns:[]},0,ue,"data-v-a1e0c4e8",!1),ve={name:"comment-preview",props:{content:{type:String,default:""},isResolved:{type:Boolean,default:!1}}};ne(".content[data-v-3d625308]{margin-top:.375rem}.content pre[data-v-3d625308]{height:100%;margin:0;padding:0 .25rem .5rem 0;font:inherit;white-space:pre-wrap;word-break:break-all;word-wrap:break-word;overflow-wrap:break-word;background:inherit;border:none;overflow:hidden}.content.resolved[data-v-3d625308]{opacity:.7}.content.resolved .resolvement-options[data-v-3d625308]{display:flex;align-items:center;margin-bottom:.25rem;font-size:.75rem}");var fe=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="Preview.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content",class:{resolved:e.isResolved}},[e.isResolved?n("div",{staticClass:"resolvement-options"},[n("span",{staticClass:"font-italic mr-1"},[e._v("Marked as resolved.")]),e._v(" "),n("v-tooltip",{attrs:{"open-delay":"800",right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({attrs:{color:"secondary",text:"","x-small":""},on:{click:e.$listeners.unresolve}},i),[e._v("\n          Undo\n        ")])]}}],null,!1,3181083862)},[e._v(" "),n("span",[e._v("Unresolve comment")])])],1):e._e(),e._v(" "),n("pre",[n("span",[e._v(e._s(e.content))]),n("br")])])},staticRenderFns:[]},0,ve,"data-v-3d625308",!1),pe={name:"thread-comment",props:{comment:{type:Object,required:!0},isActivityThread:{type:Boolean,default:!1},elementLabel:{type:String,default:null},user:{type:Object,required:!0}},data:function(e){return{content:e.comment.content,isEditing:!1}},computed:{isResolved:function(e){return!!e.comment.resolvedAt}},methods:{toggleEdit:function(){this.isEditing=!this.isEditing},save:function(){var e=this.comment,t=this.content;if(!t)return this.remove();this.toggleEdit(),this.$emit("update",e,t)},remove:function(){this.$emit("remove",this.comment)},reset:function(){this.content=this.comment.content,this.isEditing=!1}},watch:{comment:{deep:!0,handler:"reset"}},components:{CommentHeader:me,CommentPreview:fe}};ne(".comment[data-v-3d04e7dc]{display:flex;flex-direction:column;font-family:Roboto,Arial,sans-serif}.comment-body[data-v-3d04e7dc]{flex:1;padding:0 .25rem 0 2.625rem}.comment-editor.v-textarea[data-v-3d04e7dc]{margin:.75rem 0 0 0}.comment-editor.v-textarea[data-v-3d04e7dc]  .v-input__slot{width:auto}");var he=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="index.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"comment"},[n("comment-header",e._b({on:{toggleEdit:e.toggleEdit,remove:e.remove,resolve:function(t){return e.$emit("resolve",e.comment)}}},"comment-header",{comment:e.comment,isActivityThread:e.isActivityThread,isResolved:e.isResolved,elementLabel:e.elementLabel,user:e.user},!1)),e._v(" "),n("div",{staticClass:"comment-body"},[e.isEditing?[n("v-textarea",{staticClass:"comment-editor",attrs:{rows:"3",autofocus:"",outlined:"","auto-grow":"",clearable:"",counter:""},model:{value:e.content,callback:function(t){e.content="string"==typeof t?t.trim():t},expression:"content"}}),e._v(" "),n("span",{staticClass:"d-flex justify-end"},[n("v-btn",{attrs:{text:"",small:""},on:{click:e.reset}},[e._v("Cancel")]),e._v(" "),n("v-btn",{attrs:{color:"green",text:"",small:""},on:{click:e.save}},[n("v-icon",{staticClass:"pr-1"},[e._v("mdi-check")]),e._v(" Save\n        ")],1)],1)]:n("comment-preview",e._b({on:{unresolve:function(t){return e.$emit("unresolve",e.comment)}}},"comment-preview",{content:e.content,isResolved:e.isResolved},!1))],2)],1)},staticRenderFns:[]},0,pe,"data-v-3d04e7dc",!1),ye={name:"thread-list",inject:["$teRegistry"],props:{comments:{type:Array,default:function(){return[]}},isActivityThread:{type:Boolean,default:!1},elementLabel:{type:String,default:null},user:{type:Object,required:!0}},methods:{getElementLabel:function(e){var t,n=e.contentElement;if(n)return null===(t=L.default(this.$teRegistry._registry,{type:n.type}))||void 0===t?void 0:t.name}},components:{ThreadComment:he}};ne(".thread-list[data-v-b5620cec]{margin:0;padding:0;list-style:none}.thread-list .thread-list-item .v-divider[data-v-b5620cec]{margin:0 .25rem 1rem .25rem}.thread-list .thread-list-item:first-child .v-divider[data-v-b5620cec]{display:none}");var ge=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="List.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"thread-list"},e._l(e.comments,(function(t){return n("li",{key:t.uid,staticClass:"thread-list-item"},[n("v-divider"),e._v(" "),n("thread-comment",e._g(e._b({staticClass:"mb-3",attrs:{"element-label":e.getElementLabel(t)}},"thread-comment",{comment:t,isActivityThread:e.isActivityThread,user:e.user},!1),e.$listeners))],1)})),0)},staticRenderFns:[]},0,ye,"data-v-b5620cec",!1),be={name:"unseen-divider",props:{count:{type:Number,required:!0}},computed:{unseenCommentsLabel:function(e){var t=e.count;return"".concat(t," new ").concat(P.default("message",t))}}};ne(".unseen-divider[data-v-221b9d72]{text-align:center}.unseen-divider .v-divider[data-v-221b9d72]{margin:1rem 0 .25rem}.unseen-divider[data-v-221b9d72]  .v-chip.v-chip--outlined.v-chip{margin:-1.5rem 0 .5rem 0;border-radius:1rem!important;background-color:#fafafa!important}.unseen-divider[data-v-221b9d72]  .v-chip.v-chip--outlined.v-chip .v-chip__content .v-chip__close{margin-top:.125rem;font-size:.75rem!important}");var _e=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="UnseenDivider.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"unseen-divider"},[n("v-divider"),e._v(" "),n("v-chip",{attrs:{"close-icon":"mdi-close",color:"teal accent-4",outlined:"",small:"",close:""},on:{click:function(t){return e.$emit("seen")},"click:close":function(t){return e.$emit("seen")}}},[n("v-icon",{staticClass:"mr-1",attrs:{size:"14"}},[e._v("mdi-arrow-down")]),e._v(" "),n("span",{staticClass:"mr-2"},[e._v(e._s(e.unseenCommentsLabel))])],1)],1)},staticRenderFns:[]},0,be,"data-v-221b9d72",!1),Ce={name:"discussion-thread",props:{items:{type:Array,required:!0},showAll:{type:Boolean,default:!1},minDisplayed:{type:Number,default:5},isActivityThread:{type:Boolean,default:!1},unseenCount:{type:Number,required:!0},user:{type:Object,required:!0}},data:function(){return{isVisible:!1}},computed:{visibleComments:function(){var e=this.items,t=this.minDisplayed,n=this.showAll?e:U.default(e,t),i=se(q.default(n,"unseen"),2),r=i[0];return{seen:i[1],unseen:r}}},methods:{onUpdate:function(e,t){this.$emit("update",Object.assign({},e,{content:t}))},onIntersect:function(e,t,n){this.isVisible=n},revealUnseen:function(e){var t=this.$refs,n=this.minDisplayed;(e||this.unseenCount)<n||(this.$emit("showAll",!0),this.$nextTick((function(){var e=t.unseenDivider.$el;e&&e.scrollIntoView({behavior:"smooth"})})))},markSeen:function(){this.$emit("seen"),this.$emit("showAll",!1)}},watch:{isVisible:function(e){e&&this.unseenCount&&this.revealUnseen()},unseenCount:{immediate:!0,handler:"revealUnseen"}},components:{UnseenDivider:_e,ThreadList:ge}};ne(".discussion-thread[data-v-c6af8436]{width:100%}.discussion-thread.scroll-container[data-v-c6af8436]{max-height:31.25rem;overflow-y:scroll;overflow-x:hidden;padding-right:1.5rem;box-sizing:content-box}.discussion-thread .fade-enter-active[data-v-c6af8436],.discussion-thread .fade-leave-active[data-v-c6af8436]{transition:opacity .5s}.discussion-thread .fade-enter[data-v-c6af8436],.discussion-thread .fade-leave-to[data-v-c6af8436]{opacity:0}");var we=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="index.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"intersect",rawName:"v-intersect",value:e.onIntersect,expression:"onIntersect"}],staticClass:"discussion-thread",class:{"scroll-container":!e.isActivityThread}},[n("thread-list",e._b({on:{update:e.onUpdate,remove:function(t){return e.$emit("remove",t)},resolve:function(t){return e.$emit("resolve",t)},unresolve:function(t){return e.$emit("unresolve",t)}}},"thread-list",{isActivityThread:e.isActivityThread,user:e.user,comments:e.visibleComments.seen},!1)),e._v(" "),n("transition",{attrs:{name:"fade"}},[e.unseenCount?n("unseen-divider",{ref:"unseenDivider",attrs:{count:e.unseenCount},on:{seen:e.markSeen}}):e._e()],1),e._v(" "),n("thread-list",e._b({on:{update:e.onUpdate,remove:function(t){return e.$emit("remove",t)},resolve:function(t){return e.$emit("resolve",t)},unresolve:function(t){return e.$emit("unresolve",t)}}},"thread-list",{isActivityThread:e.isActivityThread,user:e.user,comments:e.visibleComments.unseen},!1))],1)},staticRenderFns:[]},0,Ce,"data-v-c6af8436",!1);var xe=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="ResolveButton.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"resolve-btn-container"},[n("v-tooltip",{attrs:{"open-delay":"800",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-btn",e._g({staticClass:"px-1",attrs:{color:"teal accent-4",small:"",text:""}},Object.assign({},e.$listeners,i)),[n("v-icon",{staticClass:"mr-2",attrs:{size:"24",color:"teal accent-4"}},[e._v("\n          mdi-check-box-outline\n        ")]),e._v("\n        Resolve All\n      ")],1)]}}])},[e._v(" "),n("span",[e._v("Mark all as resolved and hide discussion")])])],1)},staticRenderFns:[]},0,{name:"resolve-comments-btn"},void 0,!1),Ee={name:"tailor-embedded-discussion",inheritAttrs:!0,props:{comments:{type:Array,default:function(){return[]}},unseenComments:{type:Array,default:function(){return[]}},commentsShownLimit:{type:Number,default:5},scrollTarget:{type:String,default:"discussion"},showHeading:{type:Boolean,default:!1},showNotifications:{type:Boolean,default:!1},isActivityThread:{type:Boolean,default:!1},hasUnresolvedComments:{type:Boolean,default:!1},isVisible:{type:Boolean,default:!1},user:{type:Object,required:!0}},data:function(){return{showAll:!1,comment:{content:""}}},computed:{thread:function(){var e=this.comments,t=this.unseenComments,n=e.map((function(e){var n=t.find((function(t){return t.id===e.id}));return Object.assign({},e,{unseen:!!n})}));return z.default(n,["unseen","createdAt"],"asc")},commentsCount:function(e){return e.thread.length},hasHiddenComments:function(e){return e.commentsShownLimit<e.commentsCount},isTextEditorEmpty:function(e){var t;return!(null!==(t=e.comment.content)&&void 0!==t&&t.trim())},showResolveButton:function(e){return e.hasUnresolvedComments&&!e.isActivityThread}},methods:Object.assign({},f.mapRequests("app",["showConfirmationModal"]),{post:function(){var e=this,t=this.scrollTarget,n=this.comment,i=this.user;if(n.content){var r={content:n.content,author:i,createdAt:Date.now(),updatedAt:Date.now()};this.comment={content:""},this.$emit("save",r);var a={block:"center",behavior:"smooth"};this.$nextTick((function(){return e.$refs[t].scrollIntoView(a)}))}},remove:function(e){var t=this;this.showConfirmationModal(Object.assign({title:"Remove comment",message:"Are you sure you want to remove this comment?",action:function(){return t.$emit("remove",e)}},this.onConfirmationActive()))},resolveAll:function(){var e=this;this.showConfirmationModal(Object.assign({title:"Resolve all comments",message:"Are you sure you want to resolve all comments?",action:function(){return e.$emit("resolve")}},this.onConfirmationActive()))},onConfirmationActive:function(){var e=this;return{onOpen:function(){return e.$emit("update:confirmationActive",!0)},onClose:function(){return e.$emit("update:confirmationActive",!1)}}}}),watch:{commentsCount:function(){this.$emit("change",this.thread)},isVisible:{immediate:!0,handler:function(e){var t=this;!e&&this.isActivityThread||setTimeout((function(){return t.$refs.commentInput.focus()}),500)}}},created:function(){this.comment={content:""}},components:{DiscussionThread:we,ResolveButton:xe}};ne(".embedded-discussion[data-v-5744b719]{font-family:Roboto,Arial,sans-serif}.embedded-discussion .resolve-btn-container[data-v-5744b719]{display:flex;justify-content:flex-end;margin:.5rem 0 0 0}.embedded-discussion .header[data-v-5744b719]{margin:.875rem 0 1.625rem 0;font-size:1.125rem;font-weight:400}.embedded-discussion .comment-input[data-v-5744b719]{margin:0 .25rem 0 .25rem}.embedded-discussion .alert[data-v-5744b719]  .v-icon{color:var(--v-primary-darken2)!important}");var ke=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="index.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"discussion",staticClass:"embedded-discussion"},[e.showResolveButton?n("resolve-button",{on:{click:e.resolveAll}}):e._e(),e._v(" "),n("div",{class:{"pb-7":!e.showHeading&&e.hasHiddenComments}},[e.hasHiddenComments?n("v-btn",{staticClass:"float-right mt-1",attrs:{text:"","x-small":""},on:{click:function(t){e.showAll=!e.showAll}}},[e._v("\n      Show "+e._s(e.showAll?"less":"more")+"\n    ")]):e._e()],1),e._v(" "),e.showHeading?n("div",{staticClass:"header d-flex grey--text text--darken-3"},[n("v-icon",{staticClass:"mr-2",attrs:{color:"grey darken-3"}},[e._v("\n      mdi-forum-outline\n    ")]),e._v("\n    Comments\n  ")],1):e._e(),e._v(" "),!e.commentsCount&&e.showNotifications?n("v-alert",{staticClass:"alert",attrs:{color:"primary lighten-5",icon:"mdi-keyboard-outline",prominent:""}},[n("span",{staticClass:"px-1 subtitle-2"},[e._v("\n      Be the First to Comment!\n    ")])]):e._e(),e._v(" "),e.thread.length?n("discussion-thread",{staticClass:"mt-2",attrs:{items:e.thread,"show-all":e.showAll,"min-displayed":e.commentsShownLimit,"is-activity-thread":e.isActivityThread,"unseen-count":e.unseenComments.length,user:e.user},on:{update:function(t){return e.$emit("update",t)},resolve:function(t){return e.$emit("resolve",t)},unresolve:function(t){return e.$emit("unresolve",t)},seen:function(t){return e.$emit("seen")},remove:e.remove,showAll:function(t){e.showAll=t}}}):e._e(),e._v(" "),n("div",{ref:"inputContainer",staticClass:"text-right"},[n("v-textarea",{ref:"commentInput",staticClass:"comment-input",attrs:{placeholder:e.commentsCount?"Add a comment...":"Start the discussion...",rows:"3",outlined:"","auto-grow":"",clearable:"",counter:""},on:{focus:function(t){return e.$emit("seen")}},model:{value:e.comment.content,callback:function(t){e.$set(e.comment,"content","string"==typeof t?t.trim():t)},expression:"comment.content"}}),e._v(" "),n("v-btn",{attrs:{disabled:e.isTextEditorEmpty,icon:""},on:{click:e.post}},[n("v-icon",[e._v("mdi-send")])],1)],1)],1)},staticRenderFns:[]},0,Ee,"data-v-5744b719",!1),Re={name:"tailor-element-discussion",props:{id:{type:Number,default:null},uid:{type:String,required:!0},comments:{type:Array,required:!0},hasUnresolvedComments:{type:Boolean,default:!1},lastSeen:{type:Number,required:!0},user:{type:Object,required:!0}},data:function(){return{isVisible:!1,isConfirmationActive:!1}},computed:Object.assign({},f.mapChannels({editorBus:"editor"}),{events:function(){return n.Events.Discussion},lastCommentAt:function(e){return new Date(N.default(e.comments[0],"createdAt",0)).getTime()},unseenComments:function(){var e=this.comments,t=this.user,n=this.lastSeen;return e.filter((function(e){var i=new Date(e.createdAt).getTime();return e.author.id!==t.id&&i>n}))},activator:function(){var e=this.comments,t=this.unseenComments,n=t.length?"unseen":e.length?"preview":"post";return function(e){return{unseen:{class:"teal accent-4 white--text",tooltip:"View new comments",text:e.length},preview:{icon:"mdi-comment-text-multiple-outline",color:"primary darken-4",tooltip:"View comments"},post:{icon:"mdi-message-plus-outline",color:"primary darken-4",tooltip:"Post a comment"}}}(t)[n]}}),methods:{save:function(e){var t=this.user,i=this.id,r=this.hasUnresolvedComments;return this.editorBus.emit(n.Events.Discussion.SAVE,Object.assign({},e,{author:t,contentElementId:i,hasUnresolvedComments:r}))},setLastSeen:function(e){var t=this.uid,n=this.lastCommentAt,i=this.events,r={elementUid:t,lastCommentAt:n,timeout:e};this.editorBus.emit(i.SET_LAST_SEEN,r)},resolve:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.resolvedAt,i=this.id,r=this.events;this.editorBus.emit(r.RESOLVE,{id:t,contentElementId:i,resolvedAt:n})}},watch:{isVisible:function(e){e&&this.$emit("open")}},components:{Discussion:ke}};ne("[data-v-382b8ce9] .v-menu__content{background:#fff}[data-v-382b8ce9] .v-menu__content .embedded-discussion{text-align:left}[data-v-382b8ce9] .v-menu__content .comment .author{font-size:.875rem}.unseen[data-v-382b8ce9]{font-size:.75rem}");var Ae=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="ElementDiscussion.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-menu",{attrs:{"close-on-content-click":!1,"close-on-click":!e.isConfirmationActive,"min-width":"300",transition:"slide-y-transition",left:"","offset-y":"",attach:""},nativeOn:{click:function(e){e.stopPropagation()}},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[n("v-tooltip",{attrs:{"open-delay":"800",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-btn",e._g({class:e.activator.class,attrs:{"x-small":"",icon:""}},Object.assign({},i,r)),[e.activator.text?n("div",{staticClass:"unseen"},[e._v(e._s(e.activator.text))]):n("v-icon",{attrs:{color:e.activator.color,size:"18"}},[e._v("\n            "+e._s(e.activator.icon)+"\n          ")])],1)]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(e.activator.tooltip))])])]}}]),model:{value:e.isVisible,callback:function(t){e.isVisible=t},expression:"isVisible"}},[e._v(" "),n("discussion",e._b({staticClass:"pa-2",attrs:{"confirmation-active":e.isConfirmationActive},on:{save:e.save,update:e.save,remove:function(t){return e.editorBus.emit(e.events.REMOVE,t)},seen:e.setLastSeen,resolve:e.resolve,"update:confirmationActive":function(t){e.isConfirmationActive=t},"update:confirmation-active":function(t){e.isConfirmationActive=t}}},"discussion",{comments:e.comments,unseenComments:e.unseenComments,hasUnresolvedComments:e.hasUnresolvedComments,user:e.user,isVisible:e.isVisible},!1))],1)},staticRenderFns:[]},0,Re,"data-v-382b8ce9",!1);var Se=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="PublishDiffChip.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this.$createElement,t=this._self._c||e;return this.changeType?t("v-chip",{staticClass:"readonly font-weight-medium text-capitalize",attrs:{"text-color":"new"===this.changeType?"success":"secondary",color:"primary lighten-5",small:"",round:""}},[this._v("\n  "+this._s(this.changeType)+"\n")]):this._e()},staticRenderFns:[]},0,{name:"tailor-publish-diff-chip",props:{changeType:{validator:function(e){return!e||Object.values(n.publishDiffChangeTypes).includes(e)},default:null}}},void 0,!1),$e={name:"tailor-content-element",inject:{$getCurrentUser:{},$editorState:{default:{}}},inheritAttrs:!1,props:{element:{type:Object,required:!0},parent:{type:Object,default:null},isHovered:{type:Boolean,default:!1},isDragged:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1},frame:{type:Boolean,default:!0},dense:{type:Boolean,default:!1},showDiscussion:{type:Boolean,default:!1}},data:function(){return{isFocused:!1,isSaving:!1,activeUsers:[]}},computed:Object.assign({},f.mapChannels({editorBus:"editor"}),{id:function(e){return n.getElementId(e.element)},componentName:function(e){return n.getComponentName(e.element.type)},isEmbed:function(e){return!!e.parent||!e.element.uid},isHighlighted:function(e){return e.isFocused||e.isHovered},hasComments:function(e){var t;return!(null===(t=e.element.comments)||void 0===t||!t.length)},elementBus:function(e){return e.$radio.channel("element:".concat(e.id))},currentUser:function(e){return e.$getCurrentUser()}}),methods:{onSelect:function(e){this.isDisabled||this.$editorState.isPublishDiff||e.component||(this.focus(),e.component={name:"content-element",data:this.element})},onSave:function(e){this.isEmbed||(this.isSaving=!0),this.$emit("save",e)},focus:function(){this.editorBus.emit("element:focus",this.element,this.parent)}},created:function(){var e=this;this.elementBus.on("delete",(function(){return e.$emit("delete")})),this.elementBus.on("save:meta",(function(t){return e.$emit("save:meta",t)})),this.elementBus.on("saved",(function(){return setTimeout((function(){return e.isSaving=!1}),1e3)})),this.editorBus.on("element:select",(function(t){var n=t.elementId,i=t.isSelected,r=void 0===i||i,a=t.user;if(e.id===n)return a&&a.id!==e.currentUser.id?void(r&&!e.activeUsers.find((function(e){return e.id===a.id}))?e.activeUsers.push(a):!r&&e.activeUsers.find((function(e){return e.id===a.id}))&&(e.activeUsers=e.activeUsers.filter((function(e){return e.id!==a.id})))):(e.isFocused=r,void(r&&e.focus()))})),this.editorBus.on("element:focus",(function(t){e.isFocused=!!t&&n.getElementId(t)===e.id}))},provide:function(){return{$elementBus:this.elementBus}},components:{ActiveUsers:ie,Discussion:Ae,PublishDiffChip:Se}};ne(".content-element[data-v-74c5ccda]{position:relative;border:1px solid transparent}.content-element[data-v-74c5ccda]::after{content:'';display:none;position:absolute;top:0;right:-.125rem;width:.125rem;height:100%}.content-element.focused[data-v-74c5ccda]{border:1px dashed #1de9b6}.content-element.focused[data-v-74c5ccda]::after{display:block;background:#1de9b6}.content-element.selected[data-v-74c5ccda]{border:1px dashed #ff4081}.content-element.selected[data-v-74c5ccda]::after{display:block;background:#ff4081}.frame[data-v-74c5ccda]{padding:10px 20px;border:1px solid #e1e1e1}.element-actions[data-v-74c5ccda]{display:flex;flex-direction:column;position:absolute;top:-.0625rem;right:-1.25rem;width:1.5rem;height:100%;padding-left:.75rem}.element-actions>*[data-v-74c5ccda]{min-height:1.75rem;opacity:0;transition:opacity .1s linear}.element-actions>.is-visible[data-v-74c5ccda]{opacity:1;transition:opacity .5s linear}.active-users[data-v-74c5ccda]{position:absolute;top:0;left:-1.625rem}.save-indicator[data-v-74c5ccda]{position:absolute;bottom:-.125rem;left:0}.header[data-v-74c5ccda]{width:100%;max-height:0}.header.visible[data-v-74c5ccda]{max-height:unset;padding:0 0 .5rem}.diff.new[data-v-74c5ccda]{border:none;box-shadow:0 0 0 2px var(--v-success-lighten2)!important}.diff.changed[data-v-74c5ccda],.diff.removed[data-v-74c5ccda]{border:none;box-shadow:0 0 0 2px var(--v-secondary-lighten4)!important}.diff .element-actions[data-v-74c5ccda]{display:none}");var Fe=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="ContentElement.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-element",class:[e.element.changeSincePublish,{selected:e.activeUsers.length,focused:e.isFocused,diff:e.$editorState.isPublishDiff,frame:e.frame}],on:{click:e.onSelect}},[n("div",{staticClass:"header d-flex",class:{visible:e.$editorState.isPublishDiff&&e.element.changeSincePublish}},[n("publish-diff-chip",{staticClass:"ml-auto ",attrs:{"change-type":e.element.changeSincePublish}})],1),e._v(" "),n("active-users",{staticClass:"active-users",attrs:{users:e.activeUsers,size:20}}),e._v(" "),n(e.componentName,e._b({tag:"component",attrs:{id:"element_"+e.id},on:{add:function(t){return e.$emit("add",t)},save:e.onSave,delete:function(t){return e.$emit("delete")},focus:e.onSelect}},"component",Object.assign({},e.$attrs,{element:e.element,isFocused:e.isFocused,isDragged:e.isDragged,isDisabled:e.isDisabled,dense:e.dense}),!1)),e._v(" "),e.isDisabled?e._e():n("div",{staticClass:"element-actions"},[e.showDiscussion?n("div",{class:{"is-visible":e.isHighlighted||e.hasComments}},[n("discussion",e._b({attrs:{user:e.currentUser},on:{open:e.focus}},"discussion",e.element,!1))],1):e._e(),e._v(" "),e.parent?e._e():n("div",{class:{"is-visible":e.isHighlighted}},[n("v-btn",{attrs:{color:"pink lighten-1",dark:"",icon:"","x-small":""},on:{click:function(t){return e.$emit("delete")}}},[n("v-icon",{attrs:{size:"20"}},[e._v("mdi-delete-outline")])],1)],1)]),e._v(" "),e.isSaving?n("v-progress-linear",{staticClass:"save-indicator",attrs:{height:"2",color:"teal accent-2",indeterminate:""}}):e._e()],1)},staticRenderFns:[]},0,$e,"data-v-74c5ccda",!1),Ie={name:"content-element-preview",props:{element:{type:Object,required:!0},selectable:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},selectionDisabled:{type:Boolean,default:!1}},computed:{disabled:function(e){return e.selectionDisabled&&!e.isSelected},elementWidth:function(e){return"col-xs-".concat(N.default(e.element,"data.width",12))}},methods:{toggleSelection:function(){this.selectable&&!this.disabled&&this.$emit("toggle")}},components:{ContentElement:Fe}};ne(".element-preview-container[data-v-72d4e8ff]{display:flex;position:relative;margin:.25rem 0}.element-preview-container .v-input[data-v-72d4e8ff]{margin:0}.content-element[data-v-72d4e8ff]{flex:1 0;margin:.4375rem 0 0 .25rem;box-shadow:none;border:1px solid #e1e1e1}.content-element.selected[data-v-72d4e8ff]{border-style:dashed;border-color:#444}.content-element.selected[data-v-72d4e8ff]::after{display:none}.element-preview-container[data-v-72d4e8ff]  .contained-content{margin:0}.element-preview-container[data-v-72d4e8ff]  .contained-content .message span:not(.heading){display:none}.element-preview-container[data-v-72d4e8ff]  .contained-content .ql-editor{word-break:break-all}.element-wrapper[data-v-72d4e8ff]{position:relative}.open-element-button[data-v-72d4e8ff]{position:absolute;top:0;right:-.75rem;transition:opacity .4s}.open-element-button[data-v-72d4e8ff]:not(.visible){opacity:0}");var Te=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="Element.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"element-preview-container float-none",class:e.elementWidth},[e.selectable?n("v-checkbox",{attrs:{"input-value":e.isSelected,disabled:e.disabled,color:"primary darken-4"},on:{click:e.toggleSelection}}):e._e(),e._v(" "),n("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.hover;return[n("div",{staticClass:"element-wrapper flex-grow-1"},[n("content-element",e._b({staticClass:"content-element",class:{selected:e.isSelected},attrs:{element:e.element,"set-width":!1}},"content-element",e.$attrs,!1)),e._v(" "),n("v-tooltip",{attrs:{"open-delay":"400",top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-btn",e._g({staticClass:"open-element-button",class:{visible:i},attrs:{color:"blue-grey darken-4",fab:"",depressed:"","x-small":""},on:{click:function(t){return t.stopPropagation(),e.$emit("element:open",e.element.uid)}}},r),[n("v-icon",{attrs:{color:"secondary lighten-4",dense:""}},[e._v("mdi-open-in-new")])],1)]}}],null,!0)},[e._v(" "),n("span",[e._v("Open in editor")])])],1)]}}])})],1)},staticRenderFns:[]},0,Ie,"data-v-72d4e8ff",!1),Be={name:"content-preview",props:{contentContainers:{type:Array,required:!0},selectable:{type:Boolean,default:!1},multiple:{type:Boolean,default:!0},allowedTypes:{type:Array,default:function(){return[]}},selected:{type:Array,default:function(){return[]}}},computed:{isSelectionDisabled:function(){return this.selectable&&!this.multiple&&!!this.selected.length},selectionMap:function(e){return M.default(e.selected,"id")},processedContainers:function(){var e=this.contentContainers,t=this.allowedTypes;return t.length?e.map((function(e){return Object.assign({},e,{elements:e.elements.filter((function(e){return t.includes(e.type)}))})})):e},elements:function(){return this.processedContainers.reduce((function(e,t){return e.concat(t.elements)}),[])}},components:{ContentElement:Te}};ne(".content-preview .v-alert[data-v-2013b96d]{display:flex;align-items:center;justify-content:center;height:19rem}.content-preview .content-container[data-v-2013b96d]:last-child{margin-bottom:.625rem}");var De=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="index.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-preview"},[e.elements.length?e._e():n("v-alert",{staticClass:"mx-4",attrs:{color:"grey darken-4",text:""}},[e._v("\n    No available elements.\n  ")]),e._v(" "),e._l(e.processedContainers,(function(t){return n("div",{key:t.id,staticClass:"content-container d-flex flex-wrap"},e._l(t.elements,(function(t){return n("content-element",{key:t.id,attrs:{element:t,selectable:e.selectable,"is-selected":!!e.selectionMap[t.id],"selection-disabled":e.isSelectionDisabled,"is-disabled":""},on:{toggle:function(n){return e.$emit("toggle",t)},"element:open":function(t){return e.$emit("element:open",t)}}})})),1)}))],2)},staticRenderFns:[]},0,Be,"data-v-2013b96d",!1),Oe=function(){var e=new Error("Delay aborted");return e.name="AbortError",e},je=function(e){var t=e.clearTimeout,n=e.setTimeout,i=e.willResolve;return function(e){var r,a,s,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=o.value,d=o.signal;if(d&&d.aborted)return Promise.reject(Oe());var c=t||clearTimeout,u=function(){c(r),s(Oe())},m=function(){d&&d.removeEventListener("abort",u)},v=new Promise((function(t,o){a=function(){m(),i?t(l):o(l)},s=o,r=(n||setTimeout)(a,e)}));return d&&d.addEventListener("abort",u,{once:!0}),v.clear=function(){c(r),r=null,a()},v}},qe=je({willResolve:!0});qe.reject=je({willResolve:!1}),qe.range=function(e,t,n){return qe(function(e,t){return Math.floor(Math.random()*(t-e+1)+e)}(e,t),n)},qe.createWithTimers=function(e){var t=e.clearTimeout,n=e.setTimeout,i=je({clearTimeout:t,setTimeout:n,willResolve:!0});return i.reject=je({clearTimeout:t,setTimeout:n,willResolve:!1}),i};var Ue=qe,Le=qe;Ue.default=Le;var Pe=async function(e,t,n){var i;(n=Object.assign({delayRejection:!0},n)).delayRejection&&(e=e.catch((function(e){i=e})));var r=await Promise.all([e,Ue(t)]);return i?Promise.reject(i):r[0]},ze=Pe,Ne=Pe;function Me(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(){var i=this;return this[t]=!0,ze(Promise.resolve(e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))),n).finally((function(){return i[t]=!1}))}}ze.default=Ne;var Ve={name:"select-activity",inject:["$schema"],props:{selectedElements:{type:Array,default:function(){return[]}},activities:{type:Array,default:function(){return[]}}},data:function(){return{search:""}},computed:{groupedSelection:function(e){return H.default(e.selectedElements,"outlineId")},expandedActivityIds:function(e){return V.default(e.activities,"id")},activityTree:function(e){return n.toTreeFormat(e.activities,e.$schema,[])},noResultsMessage:function(){var e=this.activities,t=this.search,n=this.$refs;if(!e.length)return"Empty repository";if(!t||!n)return"";var i=n.treeview,r=i.excludedItems,a=i.nodes;return!(r.size!==Object.keys(a).length)&&"No matches found"}},methods:{hasContentContainers:function(e){return this.$schema.isEditable(e)},getChipLabel:function(e){var t=e.length;return"".concat(t," ").concat(P.default("element",t)," selected")}}};ne(".treeview[data-v-11dfe634]{max-height:19rem;text-align:left;background-color:#fcfcfc;border:1px solid #eee;overflow-y:scroll}.treeview .v-chip.custom-chip[data-v-11dfe634]{border-radius:12px!important}.treeview[data-v-11dfe634]  .v-treeview-node--leaf>.treeview ::v-deep .v-treeview-node__content>*,.treeview[data-v-11dfe634]  .v-treeview-node--leaf>.treeview ::v-deep .v-treeview-node__root{cursor:auto}");var He=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="SelectActivity.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mx-3"},[n("v-text-field",{attrs:{disabled:!e.activities.length,placeholder:"Filter items...","prepend-inner-icon":"mdi-filter-outline","clear-icon":"mdi-close-circle-outline",clearable:"",outlined:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),n("v-treeview",{directives:[{name:"show",rawName:"v-show",value:!e.noResultsMessage,expression:"!noResultsMessage"}],ref:"treeview",staticClass:"py-3 px-1 treeview",attrs:{items:e.activityTree,search:e.search,open:e.expandedActivityIds,transition:"","open-on-click":""},scopedSlots:e._u([{key:"label",fn:function(t){var i=t.item,r=i.id,a=i.data;return[e._v("\n      "+e._s(a.name)+"\n      "),e.groupedSelection[r]?n("v-chip",{staticClass:"readonly custom-chip",attrs:{rounded:"",small:""}},[e._v("\n        "+e._s(e.getChipLabel(e.groupedSelection[r]))+"\n      ")]):e._e()]}},{key:"append",fn:function(t){var i=t.item;return[e.hasContentContainers(i.type)?n("v-btn",{attrs:{color:"primary darken-2",outlined:"",small:""},on:{click:function(t){return e.$emit("selected",i)}}},[e._v("\n        View elements\n      ")]):e._e()]}}])}),e._v(" "),n("v-alert",{attrs:{value:!!e.noResultsMessage,color:"primary darken-2",dark:""}},[e._v("\n    "+e._s(e.noResultsMessage)+"\n  ")])],1)},staticRenderFns:[]},0,Ve,"data-v-11dfe634",!1);var We=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="SelectRepository.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this.$createElement;return(this._self._c||e)("v-combobox",this._b({staticClass:"mx-3",attrs:{value:this.repository,items:this.repositories,loading:this.loading,"item-value":"id","item-text":"name",label:"Select repository",placeholder:"Type to search repositories...",outlined:"","return-object":""},on:{input:this.selectRepository,"update:search-input":this.fetchRepositories}},"v-combobox",this.$attrs,!1))},staticRenderFns:[]},0,{name:"select-repository",props:{repository:{type:Object,default:null}},data:function(){return{repositories:[],loading:!1}},methods:{selectRepository:function(e){L.default(this.repositories,{id:e.id})&&this.$emit("selected",e)},fetchRepositories:W.default(Me((function(e){var t=this;return d.repository.getRepositories({search:e}).then((function(e){t.repositories=K.default(e,"name")}))}),"loading"),500)},created:function(){this.fetchRepositories()}},void 0,!1),Ke={name:"tailor-dialog",props:{headerIcon:{type:String,default:null},width:{type:[Number,String],default:500},paddingless:{type:Boolean,default:!1}}};ne(".dialog-title[data-v-b6f646a2]{display:flex;color:#f1f1f1}.dialog-title .text-truncate[data-v-b6f646a2]{flex:1;text-align:left}");var Qe=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="TailorDialog.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",e._g(e._b({attrs:{width:e.width},scopedSlots:e._u([e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)},"v-dialog",e.$attrs,!1),e.$listeners),[e._v(" "),n("v-card",[n("v-card-title",{staticClass:"dialog-title primary darken-3",attrs:{"primary-title":""}},[e.headerIcon?n("v-avatar",{staticClass:"mr-3",attrs:{color:"secondary",size:"38"}},[n("v-icon",{attrs:{dark:""}},[e._v(e._s(e.headerIcon))])],1):e._e(),e._v(" "),n("div",{staticClass:"text-truncate"},[e._t("header")],2)],1),e._v(" "),n("v-card-text",{class:[e.paddingless?"pa-0":"pt-7 px-4 pb-2"]},[e._t("body")],2),e._v(" "),e.$slots.actions?n("v-card-actions",{staticClass:"px-4 pb-3"},[n("v-spacer"),e._v(" "),e._t("actions")],2):e._e()],1)],1)},staticRenderFns:[]},0,Ke,"data-v-b6f646a2",!1),Je={label:"Select all",icon:"checkbox-multiple-marked-outline"},Ge={label:"Deselect all",icon:"checkbox-multiple-blank-outline"};var Xe=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="index.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tailor-dialog",{attrs:{value:!0,"header-icon":e.headerIcon,width:"650",scrollable:""},on:{"click:outside":e.close},scopedSlots:e._u([{key:"header",fn:function(){return[e._v(e._s(e.heading))]},proxy:!0},{key:"body",fn:function(){return[e.selection.activity?[e.toggleButton?n("div",{staticClass:"d-flex justify-end mb-2 px-4"},[n("v-btn",{attrs:{outlined:""},on:{click:e.toggleSelectAll}},[n("v-icon",{staticClass:"mr-2"},[e._v("mdi-"+e._s(e.toggleButton.icon))]),e._v("\n          "+e._s(e.toggleButton.label)+"\n        ")],1)],1):e._e(),e._v(" "),e.loadingContent?n("v-progress-circular",{staticClass:"mt-5",attrs:{indeterminate:""}}):n("content-preview",{attrs:{"content-containers":e.items.contentContainers,selected:e.selection.elements,"allowed-types":e.allowedTypes,multiple:e.multiple,selectable:""},on:{toggle:e.toggleElementSelection,"element:open":e.openInEditor}})]:[n("select-repository",{attrs:{repository:e.selection.repository,disabled:e.onlyCurrentRepo},on:{selected:e.selectRepository}}),e._v(" "),e.loadingContent?n("v-progress-circular",{staticClass:"mt-5",attrs:{indeterminate:""}}):n("select-activity",{attrs:{activities:e.items.activities,"selected-elements":e.selection.elements},on:{selected:e.showActivityElements}})]]},proxy:!0},{key:"actions",fn:function(){return[e.selection.activity?n("v-btn",{staticClass:"mr-2",attrs:{text:"",outlined:""},on:{click:e.deselectActivity}},[n("v-icon",{staticClass:"mr-2",attrs:{dense:""}},[e._v("mdi-arrow-left")]),e._v("Back\n    ")],1):e._e(),e._v(" "),n("v-btn",{staticClass:"ml-1",attrs:{text:""},on:{click:e.close}},[e._v("Cancel")]),e._v(" "),n("v-btn",{staticClass:"mr-2",attrs:{text:""},on:{click:e.save}},[e._v(e._s(e.submitLabel))])]},proxy:!0}])})},staticRenderFns:[]},0,{name:"select-element",inject:["$schema","$editorContent"],props:{selected:{type:Array,default:function(){return[]}},heading:{type:String,required:!0},allowedTypes:{type:Array,required:!0},multiple:{type:Boolean,default:!0},submitLabel:{type:String,default:"Save"},headerIcon:{type:String,default:"mdi-toy-brick-plus-outline"},onlyCurrentRepo:{type:Boolean,default:!1}},data:function(){return{items:{activities:[],contentContainers:[]},selection:{repository:null,activity:null,elements:[]},loadingContent:!1}},computed:{currentRepository:function(e){return e.$editorContent.repository},currentActivities:function(e){return e.$editorContent.activities},allElementsSelected:function(e){return e.selection.elements.length===e.elements.length},rootContainerTypes:function(){var e,t=null===(e=this.selection.activity)||void 0===e?void 0:e.type;return t&&this.getContainerTypes(t)},processedContainers:function(){var e=this,t=this.selection.activity,n=this.items.activities;if(!t||!n.length)return[];var i=K.default(n.filter(this.isRootContainer),[this.getTypePosition,"position","createdAt"]);return T.default(i,(function(t){return[t].concat(oe(e.getSubcontainers(t)))}))},elements:function(){var e=this,t=T.default(this.items.contentContainers,"elements");return this.allowedTypes.length?t.filter((function(t){return e.allowedTypes.includes(t.type)})):t},toggleButton:function(){var e=this.allElementsSelected,t=this.elements,n=this.multiple,i=this.selection;if(n&&i.activity&&t.length)return e?Ge:Je}},methods:{getContainerTypes:function(e){return V.default(this.$schema.getSupportedContainers(e),"type")},getTypePosition:function(e){var t=e.type;return this.rootContainerTypes.indexOf(t)},isRootContainer:function(e){var t=e.parentId,n=e.type,i=this.selection.activity,r=this.rootContainerTypes;return t===i.id&&r.includes(n)},getSubcontainers:function(e){var t=this.items.activities;return K.default(n.getDescendants(t,e),"position")},showActivityElements:async function(e){var t=this;this.selection.activity=e;var n=this.processedContainers,i=await this.fetchElements(n);this.items.contentContainers=n.map((function(n){return t.assignElements(n,e,i)}))},assignElements:function(e,t,n){var i=n.filter((function(t){return t.activityId===e.id})).map((function(e){return Object.assign({},e,{activity:t})}));return Object.assign({},e,{elements:K.default(i,"position")})},toggleElementSelection:function(e){var t=this.selection.elements,n=t.find((function(t){return t.id===e.id}));this.selection.elements=n?t.filter((function(t){return t.id!==e.id})):t.concat(e)},toggleSelectAll:function(){this.selection.elements=this.allElementsSelected?[]:this.elements},deselectActivity:function(){this.selection.activity=null,this.items.contentContainers=[],this.selection.elements=oe(this.selected)},selectRepository:async function(e){var t=this.currentActivities,n=this.currentRepository;this.selection.repository=e,this.deselectActivity(),this.items.activities=n.id===e.id?t:await this.fetchActivities(e)},fetchActivities:Me((function(e){return d.activity.getActivities(e.id)}),"loadingContent"),fetchElements:Me((function(e){var t={repositoryId:this.selection.repository.id,ids:e.map((function(e){return e.id}))};return d.contentElement.fetch(t)}),"loadingContent",500),save:function(){this.$emit("selected",oe(this.selection.elements)),this.close()},close:function(){this.$emit("close")},openInEditor:function(e){var t={name:"editor",params:{activityId:this.selection.activity.id,repositoryId:this.selection.repository.id},query:{elementId:e}},n=this.$router.resolve(t).href;window.open(n,"_blank")}},created:function(){this.selection.elements=oe(this.selected),this.selection.repository=this.currentRepository,this.items.activities=this.currentActivities},components:{ContentPreview:De,SelectActivity:He,SelectRepository:We,TailorDialog:Qe}},void 0,!1),Ye=6,Ze=12,et=[{name:"Content Elements",icon:"mdi-set-center"},{name:"Assessments",icon:"mdi-help-rhombus"},{name:"Nongraded questions",icon:"mdi-comment-question-outline"}];var tt=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="index.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"add-element-container"},[e._t("default",[e.large?n("v-btn",{staticClass:"mt-3 mb-4",attrs:{color:"primary darken-3",text:""},on:{click:function(t){return t.stopPropagation(),e.showElementPicker(t)}}},[n("v-icon",{staticClass:"pr-2"},[e._v(e._s(e.icon))]),e._v(e._s(e.label)+"\n    ")],1):n("v-btn",{attrs:{color:"primary darken-3",icon:"",text:""},on:{click:function(t){return t.stopPropagation(),e.showElementPicker(t)}}},[n("v-icon",[e._v(e._s(e.icon))])],1)],{addElement:e.showElementPicker}),e._v(" "),e.isVisible?[e.showElementBrowser?n("select-element",{attrs:{"allowed-types":e.allowedTypes,"submit-label":"Copy",heading:"Copy elements","header-icon":"mdi-content-duplicate",multiple:""},on:{selected:e.addElements,close:function(t){e.showElementBrowser=!1}}}):n("add-new-element",{attrs:{library:e.library,"allowed-types":e.allowedTypes},on:{add:e.addElements},scopedSlots:e._u([{key:"header",fn:function(){return[e.layout?n("div",{staticClass:"mr-6"},[n("div",{staticClass:"pb-1 caption text-left"},[e._v("Element width")]),e._v(" "),n("v-btn-toggle",{attrs:{color:"secondary accent-2",mandatory:""},model:{value:e.elementWidth,callback:function(t){e.elementWidth=t},expression:"elementWidth"}},[n("v-btn",{attrs:{value:100,height:"38",icon:""}},[n("v-icon",[e._v("mdi-square-outline")])],1),e._v(" "),n("v-btn",{attrs:{value:50,height:"38",icon:""}},[n("v-icon",[e._v("mdi-select-compare")])],1)],1)],1):e._e(),e._v(" "),n("v-btn",{staticClass:"mt-6",attrs:{color:"primary darken-3",depressed:""},on:{click:function(t){e.showElementBrowser=!e.showElementBrowser}}},[n("v-icon",{staticClass:"mr-2",attrs:{dense:""}},[e._v("mdi-content-copy")]),e._v("\n          Copy existing\n        ")],1)]},proxy:!0}],null,!1,2543524328),model:{value:e.isVisible,callback:function(t){e.isVisible=t},expression:"isVisible"}})]:e._e()],2)},staticRenderFns:[]},0,{name:"tailor-add-element",inject:["$teRegistry"],props:{items:{type:Array,required:!0},activity:{type:Object,default:null},position:{type:Number,default:null},layout:{type:Boolean,default:!0},include:{type:Array,default:null},show:{type:Boolean,default:!1},large:{type:Boolean,default:!1},label:{type:String,default:"Add content"},icon:{type:String,default:"mdi-plus"}},data:function(){return{isVisible:!1,elementWidth:100,showElementBrowser:!1}},computed:{registry:function(){return this.$teRegistry.all},questions:function(){return I.default(this.registry,{type:"QUESTION"})},contentElements:function(){var e=this,t=I.default(this.registry,(function(e){return!n.isQuestion(e.type)}));return this.isSubset?I.default(t,(function(t){return e.include.includes(t.type)})):t},assessments:function(){var e=this.registry,t=this.isSubset,n=this.include,i=this.questions;return t&&!n.includes("ASSESSMENT")?[]:I.default(e,{type:"ASSESSMENT"}).concat(i.map((function(e){return Object.assign({},e,{type:"ASSESSMENT"})})))},reflections:function(){var e=this.registry,t=this.isSubset,n=this.include,i=this.questions;return t&&!n.includes("REFLECTION")?[]:I.default(e,{type:"REFLECTION"}).concat(i.map((function(e){return Object.assign({},e,{type:"REFLECTION"})})))},isSubset:function(){return!!this.include&&!!this.include.length},library:function(){var e=[this.contentElements,this.assessments,this.reflections];return O.default(e,(function(e,t,n){return t.length&&e.push(Object.assign({},et[n],{elements:t})),e}),[])},processedWidth:function(){return 50===this.elementWidth?Ye:Ze},allowedTypes:function(){var e=this.elementWidth,t=this.include,n=this.layout,i=this.library,r=T.default(i,"elements");if(!n)return t||[];var a=(100===e?r:j.default(r,"ui.forceFullWidth")).map((function(e){return e.type}));return t?B.default(t,a):a}},methods:{addElements:function(e){var t=this,i=n.getPositions(this.items,this.position,e.length),r=e.map((function(e,n){return t.buildElement(Object.assign({},e,{position:i[n]}))}));this.$emit("add",r),this.isVisible=!1},buildElement:function(e){var t=this.processedWidth,i=this.activity,r=e.position,a=e.subtype,s=e.data,o=void 0===s?{}:s,l=e.initState,d=void 0===l?function(){return{}}:l,c=Object.assign({position:r},D.default(e,["type","refs"]),{data:Object.assign({},d(),o,{width:t})}),u=i?{activityId:i.id}:{id:n.uuid(),embedded:!0};return Object.assign(c,u),n.isQuestion(c.type)&&(c.data=function(e,t){var i={width:Ze},r=[{id:n.uuid(),data:i,type:"JODIT_HTML",embedded:!0}];return Object.assign({question:r,type:t},e.data)}(c,a)),"REFLECTION"===c.type&&delete c.data.correct,c},onHidden:function(){this.elementWidth=100,this.$emit("hidden")},showElementPicker:function(){this.isVisible=!0}},watch:{isVisible:function(e,t){!e&&t&&this.onHidden()},show:function(e){return e?this.showElementPicker():this.onHidden()}},components:{AddNewElement:ae,SelectElement:Xe}},void 0,!1),nt={name:"tailor-contained-content",inheritAttrs:!1,props:{element:{type:Object,required:!0},isDisabled:{type:Boolean,default:!1},isDragged:{type:Boolean,default:!1},setWidth:{type:Boolean,default:!0},dense:{type:Boolean,default:!1}},data:function(){return{isHovered:!1}},computed:{bindings:function(){var e=this.element,t=this.isDisabled,n=this.isDragged,i=this.isHovered,r=this.dense,a=this.$attrs;return Object.assign({element:e,isDisabled:t,isDragged:n,isHovered:i,dense:r},a)},widthClass:function(){var e=this.element;return this.setWidth?"col-xs-".concat(N.default(e,"data.width",12)):""}},methods:{scrollContainer:Q.default((function(e){var t=e.y<200,n=e.y>window.innerHeight-200;(t||n)&&window.scrollBy(0,t?-30:30)}),20)},components:{ContentElement:Fe}};ne(".drag-handle[data-v-cb586726]{position:absolute;left:-3px;z-index:2;width:26px;opacity:0}.drag-handle .mdi[data-v-cb586726]{color:#888;font-size:28px}.hovered .drag-handle[data-v-cb586726]{opacity:1;transition:opacity .6s ease-in-out;cursor:pointer}.disabled .drag-handle[data-v-cb586726]{display:none}.contained-content[data-v-cb586726]{position:relative;margin:7px 0;padding:0}");var it=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="ContainedContent.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"contained-content",class:[e.widthClass,{disabled:e.isDisabled,hovered:e.isHovered}],on:{mouseover:function(t){e.isHovered=!0},mouseleave:function(t){e.isHovered=!1},dragstart:function(t){return e.$emit("dragstart")},dragend:function(t){return e.$emit("dragend")},dragover:e.scrollContainer}},[e.isDisabled?e._e():n("span",{staticClass:"drag-handle"},[n("span",{staticClass:"mdi mdi-drag-vertical"})]),e._v(" "),n("content-element",e._b({on:{add:function(t){return e.$emit("add",t)},save:function(t){return e.$emit("save",t)},"save:meta":function(t){return e.$emit("save:meta",t)},delete:function(t){return e.$emit("delete")}}},"content-element",e.bindings,!1))],1)},staticRenderFns:[]},0,nt,"data-v-cb586726",!1),rt={name:"tailor-element-list",props:{elements:{type:Array,default:function(){return[]}},dragOptions:{type:Object,default:function(){return{}}},supportedTypes:{type:Array,default:null},activity:{type:Object,default:null},layout:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1},enableAdd:{type:Boolean,default:!0},addElementOptions:{type:Object,default:function(){return{}}}},data:function(){return{dragElementIndex:null}},computed:Object.assign({},f.mapChannels({editorChannel:"editor"}),{options:function(e){return Object.assign({},e.dragOptions,{handle:".drag-handle"})}}),methods:{get:N.default,getElementId:n.getElementId,onDragStart:function(e){this.dragElementIndex=e,this.editorChannel.emit("element:focus")},onDragEnd:function(e){this.dragElementIndex=-1,this.editorChannel.emit("element:focus",e)},reorder:function(e){var t=e.newIndex,n=this.elements;this.$emit("update",{newPosition:t,items:n})}},components:{AddElement:tt,Draggable:J.default}};ne(".list-group[data-v-f18f3e56]{padding:.625rem 1.5rem}[data-v-f18f3e56] .sortable-ghost .drag-handle{display:none}[data-v-f18f3e56] .sortable-ghost .content-element{max-height:9.375rem;background:#f4f5f5}[data-v-f18f3e56] .sortable-ghost .content-element>*{visibility:hidden}[data-v-f18f3e56] .sortable-drag .content-element{max-height:auto;background:#fff}");var at=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="ElementList.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"list-group"},[n("draggable",e._b({staticClass:"row",attrs:{list:e.elements,disabled:e.isDisabled},on:{start:function(t){e.dragElementIndex=t.oldIndex},end:function(t){e.dragElementIndex=-1},update:e.reorder}},"draggable",e.options,!1),e._l(e.elements,(function(t,i){return n("div",{key:e.getElementId(t),staticClass:"pr-5",class:"col-xs-"+e.get(t,"data.width",12),on:{dragstart:function(t){return e.onDragStart(i)},dragend:function(n){return e.onDragEnd(t)}}},[e._t("list-item",null,{element:t,isDragged:e.dragElementIndex===i,position:i})],2)})),0),e._v(" "),e.enableAdd&&!e.isDisabled?[e._t("list-add",[n("add-element",{staticClass:"mt-1",attrs:{items:e.elements,include:e.supportedTypes,activity:e.activity,label:e.addElementOptions.label,large:e.addElementOptions.large,position:e.elements.length,layout:e.layout},on:{add:function(t){return e.$emit("add",t)}}})],{include:e.supportedTypes,activity:e.activity,position:e.elements.length,layout:e.layout})]:e._e()],2)},staticRenderFns:[]},0,rt,"data-v-f18f3e56",!1);var st=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="ElementPlaceholder.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-sheet",{staticClass:"transparent grey--text text--darken-4",class:e.dense?"pt-3":"pa-12"},[n("v-avatar",{attrs:{size:e.dense?40:60,color:e.isDisabled?"grey darken-3":"primary darken-4"}},[n("v-icon",{attrs:{size:e.iconSize,color:e.isFocused?e.activeColor:"#fff"}},[e._v("\n      "+e._s(e.icon)+"\n    ")])],1),e._v(" "),n("div",{staticClass:"grey--text",class:[e.isDisabled?"text--darken-3":"text--darken-4",e.dense?"my-2 subtitle-2":"my-4 headline"]},[e._v("\n    "+e._s(e.name)+"\n  ")]),e._v(" "),e.dense||e.isDisabled?e._e():n("div",{staticClass:"subtitle-1"},[e.isFocused?[n("span",[e._v(e._s(e.activePlaceholder))]),e._v(" "),e.activeIcon?n("v-icon",{attrs:{size:"20",color:"primary darken-4"}},[e._v("\n        "+e._s(e.activeIcon)+"\n      ")]):e._e()]:[e._v(e._s(e.placeholder))]],2)],1)},staticRenderFns:[]},0,{name:"tailor-element-placeholder",props:{name:{type:String,required:!0},icon:{type:String,required:!0},placeholder:{type:String,default:"Select to edit"},activePlaceholder:{type:String,default:"Use toolbar to edit"},activeIcon:{type:String,default:null},activeColor:{type:String,default:"#fff"},isDisabled:{type:Boolean,default:!1},isFocused:{type:Boolean,default:!1},dense:{type:Boolean,default:!1}},computed:{iconSize:function(){return this.dense?this.isFocused?24:20:this.isFocused?38:30}}},void 0,!1);var ot=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="EmbeddedContainer.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("element-list",{attrs:{"add-element-options":e.addElementOptions,elements:e.embeds,"supported-types":e.types,"enable-add":!e.isDisabled&&e.enableAdd},on:{add:e.addItems,update:e.reorderItem},scopedSlots:e._u([{key:"list-item",fn:function(t){var i=t.element,r=t.isDragged;return[n("contained-content",e._b({staticClass:"my-2",attrs:{element:i,"is-dragged":r,"is-disabled":e.isDisabled},on:{save:function(t){return e.save(i,"data",t)},"save:meta":function(t){return e.save(i,"meta",t)},delete:function(t){return e.requestDeleteConfirmation(i)}}},"contained-content",e.$attrs,!1))]}}])})},staticRenderFns:[]},0,{name:"tailor-embedded-container",inheritAttrs:!1,props:{container:{type:Object,required:!0},types:{type:Array,default:function(){return["JODIT_HTML","IMAGE","HTML","VIDEO"]}},isDisabled:{type:Boolean,default:!1},addElementOptions:{type:Object,default:function(){return{}}},enableAdd:{type:Boolean,default:!0}},computed:{embeds:function(){var e=this.container.embeds;return e?Y.default(e).sort((function(e,t){return e.position-t.position})):[]}},methods:Object.assign({},f.mapRequests("app",["showConfirmationModal"]),{addItems:function(e){e=Array.isArray(e)?e:[e];var t=G.default(this.container);t.embeds=Object.assign({},t.embeds,X.default(e,"id")),this.$emit("save",t)},reorderItem:function(e){var t=e.newPosition,i=e.items,r={items:i,newPosition:t},a=G.default(this.container);a.embeds[i[t].id].position=n.calculatePosition(r),this.$emit("save",a)},save:function(e,t,n){var i=G.default(this.container);i.embeds[e.id]=Object.assign({},e,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,n)),this.$emit("save",i)},requestDeleteConfirmation:function(e){var t=this;this.showConfirmationModal({title:"Delete element?",message:"Are you sure you want to delete element?",action:function(){return t.$emit("delete",e)}})}}),components:{ContainedContent:it,ElementList:at}},void 0,!1),lt={name:"tailor-inline-activator",inheritAttrs:!1,props:{disabled:{type:Boolean,required:!1}}};ne(".default-activator-state[data-v-64eb8c58],.inline-activator[data-v-64eb8c58],.inline-activator.disabled[data-v-64eb8c58],.inline-activator.disabled[data-v-64eb8c58]:hover{padding:0 3.125rem;opacity:0}.inline-activator[data-v-64eb8c58]{display:flex;align-items:center;width:100%;margin:0;padding:0 3.125rem;opacity:0;transition:opacity .3s,padding .3s}.inline-activator[data-v-64eb8c58],.inline-activator .v-chip[data-v-64eb8c58]{cursor:pointer}.inline-activator hr[data-v-64eb8c58]{flex:1;display:inline-flex;margin:0;border-top:.0625rem dashed var(--v-primary-darken3)}.inline-activator[data-v-64eb8c58]:focus,.inline-activator[data-v-64eb8c58]:hover{padding:.75rem 0;opacity:1;outline:0;transition:opacity .3s .25s,padding .3s .1s}.inline-activator.disabled[data-v-64eb8c58],.inline-activator.disabled[data-v-64eb8c58]:hover{pointer-events:none}");var dt=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="InlineActivator.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this.$createElement,t=this._self._c||e;return t("button",this._g({staticClass:"inline-activator",class:{disabled:this.disabled}},this.$listeners),[t("hr"),this._v(" "),t("v-avatar",{attrs:{size:"20",color:"primary darken-4"}},[t("v-icon",{attrs:{size:"16",dark:""}},[this._v("mdi-plus")])],1),this._v(" "),t("hr")],1)},staticRenderFns:[]},0,lt,"data-v-64eb8c58",!1),ct={inject:["$storageService","$editorContent"],mixins:[{methods:{download:function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.target="_blank",n.click()}}}],data:function(){return{uploading:!1}},computed:{repositoryId:function(){return this.$editorContent.repository.id}},methods:Object.assign({},f.mapRequests("app",["showConfirmationModal"]),{createFileForm:function(e){this.form=new FormData;var t=se(e.target.files,1)[0];t&&this.form.append("file",t,t.name)},upload:Me((function(e){var t=this;return this.createFileForm(e),this.$storageService.upload(this.repositoryId,this.form).then((function(e){var n=t.form.get("file").name;t.$emit("upload",Object.assign({},e,{name:n}))})).catch((function(){t.error="An error has occurred!"}))}),"uploading"),downloadFile:async function(e,t){var n=await this.$storageService.getUrl(this.repositoryId,e);return this.download(n,t)},deleteFile:function(e){var t=this;this.showConfirmationModal({title:"Delete file?",message:"Are you sure you want to remove ".concat(e.fileName,"?"),action:function(){return t.$emit("delete",e.id,null)}})}})},ut={name:"upload-btn",mixins:[ct],props:{id:{type:String,default:function(){return ee.default("file_")}},fileName:{type:String,default:""},fileKey:{type:String,default:""},validate:{type:Object,default:function(){return{ext:[]}}},label:{type:String,default:"Choose a file"},sm:{type:Boolean,default:!1}},methods:{validateAndUpload:async function(e){(await this.$refs.validator.validate(e)).valid&&this.upload(e)}},watch:{uploading:function(e){this.$emit("update:uploading",e)}}};ne(".file-upload[data-v-1f089141],.upload-form[data-v-1f089141]{display:inline-block}.upload-input[data-v-1f089141]{visibility:hidden;max-width:0;max-height:0}.file-name[data-v-1f089141]{color:#00f;font-size:1rem;text-decoration:underline;cursor:pointer}");var mt=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="UploadBtn.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file-upload"},[n("form",{staticClass:"upload-form",on:{submit:function(e){e.preventDefault()}}},[n("validation-provider",{ref:"validator",attrs:{rules:e.validate}},[n("input",{ref:e.id,staticClass:"upload-input",attrs:{id:e.id,name:e.id,accept:e.validate.ext,type:"file"},on:{change:e.validateAndUpload}})]),e._v(" "),e.fileKey?n("span",{staticClass:"file-name",on:{click:function(t){return e.downloadFile(e.fileKey,e.fileName)}}},[e._v(e._s(e.fileName)+"\n    ")]):n("v-btn",{attrs:{loading:e.uploading,color:"grey darken-4",text:""},on:{click:function(t){return e.$refs[e.id].click()}}},[n("v-icon",{staticClass:"mr-2",attrs:{color:"secondary"}},[e._v("mdi-cloud-upload-outline")]),e._v("\n      "+e._s(e.label)+"\n    ")],1),e._v(" "),e.fileKey?n("v-btn",{attrs:{icon:"",small:""},on:{click:function(t){return e.deleteFile({id:e.id,fileName:e.fileName})}}},[n("v-icon",[e._v("mdi-delete")])],1):e._e()],1)])},staticRenderFns:[]},0,ut,"data-v-1f089141",!1);function vt(e){try{return e&&"storage:"===new URL(e).protocol}catch(e){return!1}}var ft={name:"tailor-input-asset",props:{url:{type:String,default:null},publicUrl:{type:String,default:null},extensions:{type:Array,required:!0},allowFileUpload:{type:Boolean,default:!0},uploadLabel:{type:String,default:"Select file"}},data:function(){var e=!vt(this.url);return{isEditing:!this.url,uploading:!1,file:e?null:D.default(this,["url","publicUrl"]),urlInput:e?this.url:null}},computed:{hasAsset:function(e){return e.file||e.urlInput},isLinked:function(e){return!!e.urlInput},hasChanges:function(e){return e.url!==(e.isLinked?e.urlInput:N.default(e,"file.url",null))},fileName:function(){return this.file?Z.default(this.file.url.split("___")):null}},methods:{save:async function(){if(this.$refs.provider&&!(await this.$refs.provider.validate()).valid)return;this.isEditing=!1;var e=this.file||{url:this.urlInput,publicUrl:this.urlInput};this.$emit("input",e)},cancel:function(){var e=!vt(this.url);this.urlInput=e?this.url:null,this.file=e?null:D.default(this,["url","publicUrl"]),this.isEditing=!this.url}},components:{UploadBtn:mt}};ne(".v-text-field[data-v-6cc584d4]{min-width:21.875rem;margin:.5rem .75rem 0 1.75rem}.action[data-v-6cc584d4]  .v-btn__content{min-width:4rem!important}.upload-btn[data-v-6cc584d4]  .v-btn{height:100%}.upload-btn[data-v-6cc584d4]  .v-btn .v-btn__content{padding:1.5rem 0}");var pt=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="InputAsset.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-toolbar-items",[e.url&&!e.isEditing?n("v-btn",{attrs:{href:e.publicUrl||e.url,target:"_blank",color:"info",text:""}},[n("v-icon",[e._v("mdi-open-in-new")])],1):e._e(),e._v(" "),e.allowFileUpload?n("upload-btn",{directives:[{name:"show",rawName:"v-show",value:!e.file&&e.isEditing,expression:"!file && isEditing"}],staticClass:"upload-btn",attrs:{uploading:e.uploading,validate:{ext:e.extensions},"confirm-deletion":!1,label:e.uploadLabel},on:{upload:function(t){return(e.file=t)&&(e.urlInput=null)},"update:uploading":function(t){e.uploading=t}}}):e._e(),e._v(" "),e.file?[e.isEditing?n("v-btn",{attrs:{color:"red",text:""},on:{click:function(t){t.stopPropagation(),e.file=null}}},[n("v-icon",[e._v("mdi-delete")])],1):e._e(),e._v(" "),n("v-text-field",{attrs:{value:e.fileName,readonly:"","hide-details":"",filled:""}})]:e._e(),e._v(" "),e.uploading||!e.urlInput&&e.hasAsset?e._e():n("validation-provider",{ref:"provider",attrs:{rules:{url:{protocols:["http","https"],require_protocol:!0,require_valid_protocol:!0}},name:"URL"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[n("v-text-field",{attrs:{"error-messages":i,disabled:!e.isEditing,placeholder:e.allowFileUpload?"or paste a URL...":"Paste a URL...",filled:"",clearable:""},model:{value:e.urlInput,callback:function(t){e.urlInput=t},expression:"urlInput"}})]}}],null,!1,17370557)}),e._v(" "),e.isEditing?[e.hasChanges?n("v-btn",{staticClass:"action",attrs:{disabled:e.uploading,text:""},on:{click:function(t){return t.stopPropagation(),e.save(t)}}},[e._v("\n      Save\n    ")]):e._e(),e._v(" "),e.hasChanges||e.url?n("v-btn",{staticClass:"action",attrs:{disabled:e.uploading,text:""},on:{click:function(t){return t.stopPropagation(),e.cancel(t)}}},[e._v("\n      Cancel\n    ")]):e._e()]:n("v-btn",{staticClass:"action",attrs:{text:""},on:{click:function(t){t.stopPropagation(),e.isEditing=!0}}},[e._v("\n    Edit\n  ")])],2)},staticRenderFns:[]},0,ft,"data-v-6cc584d4",!1),ht={name:"tailor-input-error",props:{error:{type:String,default:""}}};ne(".input-error[data-v-ff8d03d8]{color:var(--v-error-base);font-size:.75rem}");var yt=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="InputError.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this.$createElement,t=this._self._c||e;return t("transition",{attrs:{name:"message-transition"}},[this.error?t("div",{staticClass:"input-error"},[this._v("\n    "+this._s(this.error)+"\n  ")]):this._e()])},staticRenderFns:[]},0,ht,"data-v-ff8d03d8",!1),gt={name:"tailor-preview-overlay",props:{show:{type:Boolean,default:!1}}};ne(".message[data-v-20303d2e]{border-radius:2px;font-size:1.125rem}");var bt=function(e,t,n,i,r,a,s,o){var l=("function"==typeof n?n.options:n)||{};return l.__file="PreviewOverlay.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),l._scopeId=i,l}({render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-overlay",{attrs:{value:this.show,opacity:"0.9",absolute:""}},[t("button",{staticClass:"message pa-2 grey--text text--lighten-2"},[this._t("default",[this._v("Click to preview")])],2)])},staticRenderFns:[]},0,gt,"data-v-20303d2e",!1);e.ActiveUsers=ie,e.AddElement=tt,e.ContainedContent=it,e.ContentElement=Fe,e.Discussion=ke,e.ElementList=at,e.ElementPlaceholder=st,e.EmbeddedContainer=ot,e.InlineActivator=dt,e.InputAsset=pt,e.InputError=yt,e.PreviewOverlay=bt,e.PublishDiffChip=Se,e.SelectElement=Xe,e.UploadBtn=mt,e.upload=ct,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=tailor-components.umd.min.js.map
