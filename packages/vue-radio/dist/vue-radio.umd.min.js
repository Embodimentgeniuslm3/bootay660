!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).VueRadio={})}(this,(function(t){"use strict";function n(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function e(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}function o(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,n){return(u=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function f(t,n,e){return(f=c()?Reflect.construct:function(t,n,e){var r=[null];r.push.apply(r,n);var o=new(Function.bind.apply(t,r));return e&&u(o,e.prototype),o}).apply(null,arguments)}function a(t){var n="function"==typeof Map?new Map:void 0;return(a=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,r)}function r(){return f(t,arguments,i(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),u(r,t)})(t)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,n){return!n||"object"!=typeof n&&"function"!=typeof n?s(t):n}function p(t,n,e){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,n,e){var r=function(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=i(t)););return t}(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(e):o.value}})(t,n,e||t)}function y(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],r=!0,o=!1,i=void 0;try{for(var u,c=t[Symbol.iterator]();!(r=(u=c.next()).done)&&(e.push(u.value),!n||e.length!==n);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return e}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return h(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return h(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var v=function(t){return"function"==typeof t},b=function(t){return t[t.length-1]},d=function(){},g=function(t){return"reply->".concat(t)},m=function(t){return"request->".concat(t)},w=function(){function t(e,r){var i=this;n(this,t),o(this,"eventName",(function(t){return i._id?[i._id,t].join("/"):t})),o(this,"emit",O("$emit")),o(this,"on",O("$on")),o(this,"once",O("$once")),o(this,"off",O("$off")),this._bus=e,this._id=r,this._repliers=new Map}return r(t,[{key:"request",value:function(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];var o=v(b(e))?e.pop():d;return this.once(g(t),o),this.emit.apply(this,[m(t)].concat(e)),this}},{key:"reply",value:function(t,n){var e=this,r=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e.emit.apply(e,[g(t)].concat(r))},o=function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.apply(void 0,e.concat([r]))};return this._repliers.set(n,o),this.on(m(t),o),this}},{key:"replyOnce",value:function(t,n){var e=this,r=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e.emit.apply(e,[g(t)].concat(r))},o=function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.apply(void 0,e.concat([r]))};return this._repliers.set(n,o),this.once(m(t),o),this}},{key:"stopReplying",value:function(t,n){var e=this._repliers.get(n);return e&&this._repliers.delete(e),this.off(m(t),e),this}}]),t}();function O(t){return function(n){for(var e,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return(e=this._bus)[t].apply(e,[this.eventName(n)].concat(o)),this}}var _=function(){function t(e){n(this,t),this._bus=e}return r(t,[{key:"channel",value:function(t){var n=this.constructor._channels;if(n.has(t))return n.get(t);var e=new w(this._bus,t);return n.set(t,e),e}}],[{key:"getInstance",value:function(n){return this._instance=this._instance=new t(n.$root),this._instance}}]),t}();o(_,"_instance",null),o(_,"_channels",new Map);function j(t){return Array.isArray(t)?t.reduce((function(t,n){return Object.assign(t,o({},n,n))}),{}):t}function R(t,n){return Object.entries(t).reduce((function(t,e){var r=y(e,2),i=r[0],u=r[1];return u=n(u,i),Object.assign(t,o({},i,u))}),{})}var A=function(t){Object.defineProperty(t.prototype,"$radio",{get:function(){var t=this,e=_.getInstance(this);return{channel:function(f){return function(t,e){var f=new(function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&u(t,n)}(y,t);var e,f,a=(e=y,f=c(),function(){var t,n=i(e);if(f){var r=i(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function y(t){var e;return n(this,y),o(s(e=a.call(this)),"run",(function(){return e.forEach((function(t){return t()}))})),e._vm=t,e}return r(y,[{key:"set",value:function(t,n){return this.size||this._vm.$once("hook:beforeDestroy",this.run),p(i(y.prototype),"set",this).call(this,t,n),this}},{key:"delete",value:function(t){return p(i(y.prototype),"delete",this).call(this,t),this.size||this._vm.$off("hook:beforeDestroy",this.run),this}}]),y}(a(Map)))(e);return{emit:t.emit.bind(t),request:t.request.bind(t),on:function(n,e){return f.set(e,(function(){return t.off(n,e)})),t.on(n,e)},once:function(n,e){return f.set(e,(function(){return t.off(n,e)})),t.once(n,e)},reply:function(n,e){return f.set(e,(function(){return t.stopReplying(n,e)})),t.reply(n,e)},replyOnce:function(n,e){return f.set(e,(function(){return t.stopReplying(n,e)})),t.replyOnce(n,e)},off:function(n,e){return f.delete(e),t.off(n,e)},stopReplying:function(n,e){return f.delete(e),t.stopReplying(n,e)}}}(e.channel(f),t)},emit:f("emit"),on:f("on"),once:f("once"),off:f("off"),request:f("request"),reply:f("reply"),replyOnce:f("replyOnce"),stopReplying:f("stopReplying")};function f(t){var n=this;return function(e){for(var r=n.channel(e),o=arguments.length,i=new Array(o>1?o-1:0),u=1;u<o;u++)i[u-1]=arguments[u];return r[t].apply(r,i),n}}}})};t.default=A,t.install=A,t.mapChannels=function(t){return R(j(t),(function(t){return function(n){return n.$radio.channel(t)}}))},t.mapRequests=function(t,n){var e="function"!=typeof t?function(n){return n.$radio.channel(t)}:t;return R(j(n),(function(t){return function(){for(var n,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=e(this)).request.apply(n,[t].concat(o))}}))},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=vue-radio.umd.min.js.map
